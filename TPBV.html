<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dashboard de TPBV con IA Activa y TTS</title>

  <!-- Tailwind (keep non-deferred to avoid FOUC with CDN runtime) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Chart.js (no defer so inline logic at bottom has it available) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
          integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700;800&family=Roboto+Condensed:wght@400;700&display=swap" rel="stylesheet" />

  <style>
    :root{
      --brand-green:#71785b;
      --brand-gold:#bc9b73;
      --brand-dark-green:#2E3B2B;
      --brand-light-gray:#F3F4F6;
      --brand-purple:#773357;
      --brand-brown:#7C4A36;
    }
    html,body{height:100%}
    body{
      font-family:'Roboto Condensed',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:#111827;background:var(--brand-light-gray);
      -webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;
    }
    h1,h2,.card-value,.info-value,.gemini-button{font-family:'Montserrat',sans-serif}
    .container-narrow{max-width:1200px;margin-inline:auto}
    .card{background:#fff;border:1px solid #E5E7EB;border-radius:.75rem;padding:1.25rem;box-shadow:0 1px 2px rgb(0 0 0 / .04)}
    .card-title{font-weight:700;font-size:.8rem;letter-spacing:.06em;color:#6B7280;text-transform:uppercase;margin-bottom:.25rem}
    .card-value{font-weight:800;font-size:2.125rem;line-height:1.1;color:var(--brand-dark-green)}
    .section-title{display:flex;align-items:center;gap:.75rem;font-weight:800;color:var(--brand-dark-green);font-size:1.25rem;padding-bottom:.5rem;border-bottom:3px solid var(--brand-gold);margin-bottom:1rem}
    .info-row{display:flex;justify-content:space-between;gap:.75rem;padding:.375rem .25rem;border-bottom:1px solid #F3F4F6;font-size:.95rem}
    .info-row span:first-child{color:#6B7280}
    .info-value{color:var(--brand-green);font-weight:800;font-size:1.25rem}
    .gemini-button{background:var(--brand-green);color:#fff;border:none;border-radius:.5rem;font-weight:700;padding:.75rem 1rem;display:inline-flex;align-items:center;justify-content:center;cursor:pointer}
    .tts-button{background:var(--brand-gold)}
    #map{width:100%;height:100%;min-height:320px;border-radius:.5rem}
    .grid-2{display:grid;grid-template-columns:1fr;gap:1rem}
    @media (min-width:1024px){.grid-2{grid-template-columns:1fr 1fr}}
    .grid-cards{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:1rem}
    @media (min-width:640px){.grid-cards{grid-template-columns:repeat(4,minmax(0,1fr))}}
    @media print{
      @page{size:A4;margin:1cm}
      .no-print{display:none !important}
      .print-container{display:block !important}
      header[role="banner"].print-header{display:flex !important;justify-content:space-between;align-items:center;border-bottom:2px solid var(--brand-dark-green);padding-bottom:.5rem;margin-bottom:1rem}
      .print-main{display:grid;grid-template-columns:1fr 1fr;gap:1rem}
      .card{padding:.5rem;box-shadow:none;border:1px solid #E5E7EB}
      .card-title{font-size:.6rem}
      .card-value{font-size:1.4rem}
      canvas{max-height:180px !important}
    }
  </style>
</head>

<body class="min-h-full">
  <div class="print-container">
    <header role="banner" class="print-header hidden">
      <img src="https://cdn.prod.website-files.com/66d75f3897a0c14fc42017af/67d124efdfc13b41bfb24b65_Logo_Inicio.svg"
           alt="Logo TPBV" class="h-16" loading="lazy" />
      <div>
        <h1>Reporte Sociodemogr√°fico</h1>
        <p class="subtitle">
          <strong id="print-localidad">‚Äî</strong> | <span id="print-municipio">‚Äî</span><br />
          <time id="print-date" aria-live="polite"></time>
        </p>
      </div>
    </header>

    <main id="main" class="container-narrow px-4 sm:px-6 lg:px-8 pb-10">
      <header class="no-print text-center mb-8">
        <figure class="flex justify-center">
          <img src="https://cdn.prod.website-files.com/66d75f3897a0c14fc42017af/67d124efdfc13b41bfb24b65_Logo_Inicio.svg"
               alt="Logo TPBV" class="h-24 sm:h-32" />
        </figure>
        <h1 class="mt-4 text-3xl sm:text-4xl font-extrabold" style="color:var(--brand-green)">Dashboard de TPBV</h1>
        <p class="text-gray-600 mt-1">An√°lisis Sociodemogr√°fico Interactivo</p>
      </header>

      <aside class="no-print card mb-8">
        <form class="grid grid-cols-1 md:grid-cols-3 gap-4 items-end" aria-label="Filtros de datos">
          <label class="block">
            <span class="block text-sm font-medium text-gray-700 mb-1">Filtrar por Pol√≠gono</span>
            <select id="poligono-filter" class="w-full border border-gray-300 rounded-md p-2"></select>
          </label>
          <label class="block">
            <span class="block text-sm font-medium text-gray-700 mb-1">Seleccionar Localidad</span>
            <select id="localidad-filter" class="w-full border border-gray-300 rounded-md p-2"></select>
          </label>
          <button id="print-button" type="button" class="gemini-button w-full">Imprimir Reporte</button>
        </form>
      </aside>

      <div id="dashboard-content" class="grid-2 print-main">
        <section class="space-y-6 print-section">
          <header class="section-title"><span aria-hidden="true">‚ÑπÔ∏è</span><span>Informaci√≥n General</span></header>
          <article class="card" aria-labelledby="info-general">
            <div class="sr-only" id="info-general">Informaci√≥n general</div>
            <p class="info-row"><span>Localidad</span><span id="info-localidad">‚Äî</span></p>
            <p class="info-row"><span>Municipio</span><span id="info-municipio">‚Äî</span></p>
            <p class="info-row"><span>Grado de Marginaci√≥n</span><span id="info-marginacion">‚Äî</span></p>
          </article>

          <section id="map-container" class="no-print space-y-3" aria-label="Ubicaci√≥n geogr√°fica">
            <header class="section-title"><span aria-hidden="true">üó∫Ô∏è</span><span>Ubicaci√≥n Geogr√°fica</span></header>
            <div class="card p-2"><div id="map" role="img" aria-label="Mapa de la localidad seleccionada"></div></div>
          </section>

          <section class="space-y-3 print-section" aria-label="Poblaci√≥n">
            <header class="section-title"><span aria-hidden="true">üë•</span><span>Poblaci√≥n</span></header>
            <div class="grid-cards">
              <div class="card text-center"><h3 class="card-title">Total</h3><p id="pob-total" class="card-value">0</p></div>
              <div class="card text-center"><h3 class="card-title">Mujeres</h3><p id="pob-mujeres" class="card-value">0</p></div>
              <div class="card text-center"><h3 class="card-title">Hombres</h3><p id="pob-hombres" class="card-value">0</p></div>
              <div class="card text-center"><h3 class="card-title">Hogares</h3><p id="pob-hogares" class="card-value">0</p></div>
            </div>
          </section>

          <section class="space-y-3 print-section" aria-label="Vivienda">
            <header class="section-title"><span aria-hidden="true">üè†</span><span>Vivienda</span></header>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div class="card text-center"><h3 class="card-title">Total Viviendas</h3><p id="viv-habitadas" class="card-value">0</p></div>
              <div class="card text-center"><h3 class="card-title">Piso de Tierra</h3><p id="viv-tierra" class="card-value">0</p></div>
              <div class="card text-center sm:col-span-2"><h3 class="card-title">Con Hacinamiento</h3><p id="viv-hacinamiento" class="card-value">0</p></div>
            </div>
          </section>

          <section class="space-y-3 print-section" aria-label="Otros datos demogr√°ficos">
            <header class="section-title"><span aria-hidden="true">üßëüèΩ‚Äçü¶±</span><span>Otros Datos Demogr√°ficos</span></header>
            <div class="card" id="demo-container" aria-live="polite"></div>
          </section>

          <section class="space-y-3 print-section" aria-label="Tecnolog√≠as de Informaci√≥n (TIC)">
            <header class="section-title"><span aria-hidden="true">üì±</span><span>Tecnolog√≠as de Informaci√≥n (TIC)</span></header>
            <div class="card" id="tic-container" aria-live="polite"></div>
          </section>
        </section>

        <section class="space-y-6 print-section">
          <section class="space-y-3 print-section" aria-label="Servicios de Salud">
            <header class="section-title"><span aria-hidden="true">üè•</span><span>Servicios de Salud</span></header>
            <div class="card" id="health-container" aria-live="polite"></div>
          </section>

          <section class="space-y-3 print-section" aria-label="Educaci√≥n (15 a√±os y m√°s)">
            <header class="section-title"><span aria-hidden="true">üìö</span><span>Educaci√≥n (15 a√±os y m√°s)</span></header>
            <div class="card" id="edu-container" aria-live="polite"></div>
          </section>

          <section class="space-y-3 print-section" aria-label="Disponibilidad de Bienes">
            <header class="section-title"><span aria-hidden="true">üõ†Ô∏è</span><span>Disponibilidad de Bienes</span></header>
            <div class="card"><canvas id="bienesChart" role="img" aria-label="Gr√°fico de bienes"></canvas></div>
          </section>

          <section class="space-y-3 print-section" aria-label="Servicios y Equipamiento">
            <header class="section-title"><span aria-hidden="true">üíß</span><span>Servicios y Equipamiento</span></header>
            <div class="card"><canvas id="serviciosChart" role="img" aria-label="Gr√°fico de servicios"></canvas></div>
          </section>
        </section>

        <section id="ai-section" class="no-print lg:col-span-2 space-y-3" aria-label="An√°lisis con IA">
          <header class="section-title"><span aria-hidden="true">‚ú®</span><span>An√°lisis con IA</span></header>
          <article class="card space-y-4">
            <div class="flex flex-col sm:flex-row gap-2">
              <button id="generate-summary" type="button" class="gemini-button flex-1">‚ú® Generar Resumen</button>
              <button id="suggest-projects" type="button" class="gemini-button flex-1">üí° Sugerir Proyectos</button>
            </div>

            <div class="flex items-center justify-between">
              <h3 class="font-bold text-gray-700">Resultado del An√°lisis:</h3>
              <button id="listen-button" type="button" class="gemini-button tts-button p-2 h-10 w-10" title="Leer en voz alta" aria-label="Leer en voz alta" disabled>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.858 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.858l4.707-4.707a1 1 0 011.414 0V19.707a1 1 0 01-1.414 0L5.858 15z"/>
                </svg>
              </button>
            </div>

            <div id="gemini-loader" class="hidden items-center gap-3" aria-hidden="true">
              <div class="loader" aria-hidden="true" style="border:4px solid #f3f3f3;border-top:4px solid var(--brand-gold);border-radius:50%;width:22px;height:22px;animation:spin 1s linear infinite"></div>
              <p id="loader-text" class="text-gray-600">Analizando datos con Gemini...</p>
            </div>

            <output id="gemini-output" class="text-gray-700 bg-gray-50 p-4 rounded-md min-h-[150px] whitespace-pre-wrap" aria-live="polite">
              Seleccione una opci√≥n para ver el an√°lisis de Gemini.
            </output>
          </article>
        </section>
      </div>
    </main>

    <footer class="print-footer hidden">
      Reporte generado autom√°ticamente por el Dashboard de TPBV.
    </footer>
  </div>

  <!-- Inject the ORIGINAL dataset + logic so data renders correctly -->
  <script>
        const dataSet = [
            {"CVEGEO":170020021,"Municipio":"Atlatlahucan","Poligono":1,"Localidad":"Tlaltetelco (San Miguel Tlaltetelco)","POB1":2098,"POB42":1110,"POB84":988,"EDU28":75,"EDU34":466,"ECO1":885,"ECO7":39,"ECO13":27,"ECO28":808,"AFRO1":7,"DISC4":19,"DISC5":35,"DISC6":68,"SALUD1":1258,"SALUD2":840,"SALUD3":255,"SALUD4":70,"SALUD6":2,"VIV0":806,"VIV7":34,"VIV10":177,"VIV27":449,"VIV28":301,"VIV29":182,"VIV81":30,"VIV15":553,"VIV17":424,"VIV20":531,"VIV34":108,"VIV35":141,"VIV36":492,"GM_2020_y":"Bajo","Latitud":18.952159,"Longitud":-98.886945},
            {"CVEGEO":170020058,"Municipio":"Atlatlahucan","Poligono":1,"Localidad":"Rancho Teoxtoc","POB1":23,"POB42":12,"POB84":11,"EDU28":1,"EDU34":10,"ECO1":7,"ECO7":1,"ECO13":2,"ECO28":10,"AFRO1":0,"DISC4":0,"DISC5":2,"DISC6":3,"SALUD1":20,"SALUD2":3,"SALUD3":0,"SALUD4":1,"SALUD6":0,"VIV0":42,"VIV7":2,"VIV10":4,"VIV27":6,"VIV28":2,"VIV29":1,"VIV81":2,"VIV15":7,"VIV17":3,"VIV20":6,"VIV34":1,"VIV35":1,"VIV36":7,"GM_2020_y":"Alto","Latitud":18.953798,"Longitud":-98.895895},
            {"CVEGEO":170020078,"Municipio":"Atlatlahucan","Poligono":1,"Localidad":"Colonia Alta Vista","POB1":47,"POB42":21,"POB84":26,"EDU28":1,"EDU34":19,"ECO1":22,"ECO7":1,"ECO13":1,"ECO28":12,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":3,"SALUD1":25,"SALUD2":22,"SALUD3":9,"SALUD4":0,"SALUD6":0,"VIV0":46,"VIV7":2,"VIV10":6,"VIV27":12,"VIV28":6,"VIV29":4,"VIV81":1,"VIV15":13,"VIV17":5,"VIV20":12,"VIV34":0,"VIV35":0,"VIV36":14,"GM_2020_y":"Medio","Latitud":18.971523,"Longitud":-98.888316},
            {"CVEGEO":170020080,"Municipio":"Atlatlahucan","Poligono":1,"Localidad":"Linda Vista","POB1":20,"POB42":10,"POB84":10,"EDU28":0,"EDU34":5,"ECO1":7,"ECO7":0,"ECO13":0,"ECO28":8,"AFRO1":1,"DISC4":0,"DISC5":1,"DISC6":0,"SALUD1":11,"SALUD2":9,"SALUD3":0,"SALUD4":0,"SALUD6":0,"VIV0":21,"VIV7":3,"VIV10":3,"VIV27":3,"VIV28":1,"VIV29":2,"VIV81":1,"VIV15":5,"VIV17":4,"VIV20":3,"VIV34":0,"VIV35":0,"VIV36":6,"GM_2020_y":"Alto","Latitud":18.969407,"Longitud":-98.891804},
            {"CVEGEO":170030017,"Municipio":"Axochiapan","Poligono":2,"Localidad":"La Nopalera","POB1":412,"POB42":207,"POB84":205,"EDU28":71,"EDU34":87,"ECO1":196,"ECO7":61,"ECO13":7,"ECO28":95,"AFRO1":0,"DISC4":1,"DISC5":12,"DISC6":12,"SALUD1":341,"SALUD2":71,"SALUD3":6,"SALUD4":10,"SALUD6":1,"VIV0":106,"VIV7":10,"VIV10":31,"VIV27":58,"VIV28":46,"VIV29":31,"VIV81":43,"VIV15":73,"VIV17":72,"VIV20":63,"VIV34":7,"VIV35":19,"VIV36":65,"GM_2020_y":"Alto","Latitud":18.571663,"Longitud":-98.742371},
            {"CVEGEO":170030073,"Municipio":"Axochiapan","Poligono":2,"Localidad":"Campo Jicamal","POB1":183,"POB42":95,"POB84":88,"EDU28":5,"EDU34":48,"ECO1":94,"ECO7":3,"ECO13":5,"ECO28":32,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":0,"SALUD1":163,"SALUD2":20,"SALUD3":8,"SALUD4":1,"SALUD6":0,"VIV0":57,"VIV7":7,"VIV10":21,"VIV27":27,"VIV28":22,"VIV29":5,"VIV81":27,"VIV15":38,"VIV17":38,"VIV20":25,"VIV34":2,"VIV35":3,"VIV36":34,"GM_2020_y":"Bajo","Latitud":18.558818,"Longitud":-98.769521},
            {"CVEGEO":170040106,"Municipio":"Ayala","Poligono":3,"Localidad":"Ampliaci√≥n Chinameca","POB1":17,"POB42":9,"POB84":8,"EDU28":0,"EDU34":3,"ECO1":7,"ECO7":0,"ECO13":0,"ECO28":5,"AFRO1":1,"DISC4":0,"DISC5":0,"DISC6":0,"SALUD1":17,"SALUD2":0,"SALUD3":0,"SALUD4":0,"SALUD6":0,"VIV0":5,"VIV7":1,"VIV10":2,"VIV27":0,"VIV28":0,"VIV29":2,"VIV81":1,"VIV15":1,"VIV17":0,"VIV20":4,"VIV34":0,"VIV35":0,"VIV36":4,"GM_2020_y":"Alto","Latitud":18.611188,"Longitud":-99.016804},
            {"CVEGEO":170040139,"Municipio":"Ayala","Poligono":3,"Localidad":"El Crucero de Chinameca","POB1":61,"POB42":30,"POB84":31,"EDU28":4,"EDU34":11,"ECO1":36,"ECO7":3,"ECO13":2,"ECO28":13,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":0,"SALUD1":51,"SALUD2":10,"SALUD3":16,"SALUD4":1,"SALUD6":2,"VIV0":25,"VIV7":0,"VIV10":4,"VIV27":17,"VIV28":16,"VIV29":9,"VIV81":6,"VIV15":18,"VIV17":16,"VIV20":18,"VIV34":4,"VIV35":3,"VIV36":17,"GM_2020_y":"Muy bajo","Latitud":18.626111,"Longitud":-99.004167},
            {"CVEGEO":170040168,"Municipio":"Ayala","Poligono":3,"Localidad":"Colonia Pablo Torres Burgos","POB1":15,"POB42":6,"POB84":9,"EDU28":0,"EDU34":6,"ECO1":11,"ECO7":0,"ECO13":1,"ECO28":1,"AFRO1":0,"DISC4":1,"DISC5":0,"DISC6":0,"SALUD1":14,"SALUD2":1,"SALUD3":1,"SALUD4":0,"SALUD6":0,"VIV0":7,"VIV7":0,"VIV10":1,"VIV27":3,"VIV28":1,"VIV29":1,"VIV81":2,"VIV15":3,"VIV17":3,"VIV20":3,"VIV34":2,"VIV35":0,"VIV36":3,"GM_2020_y":"Bajo","Latitud":18.619196,"Longitud":-99.006067},
            {"CVEGEO":170040186,"Municipio":"Ayala","Poligono":3,"Localidad":"Ampliaci√≥n la Cucaracha","POB1":40,"POB42":20,"POB84":20,"EDU28":2,"EDU34":15,"ECO1":20,"ECO7":2,"ECO13":0,"ECO28":11,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":0,"SALUD1":28,"SALUD2":12,"SALUD3":2,"SALUD4":2,"SALUD6":2,"VIV0":15,"VIV7":3,"VIV10":3,"VIV27":7,"VIV28":5,"VIV29":5,"VIV81":0,"VIV15":8,"VIV17":1,"VIV20":7,"VIV34":2,"VIV35":1,"VIV36":8,"GM_2020_y":"Alto","Latitud":18.626411,"Longitud":-98.988651},
            {"CVEGEO":170040188,"Municipio":"Ayala","Poligono":3,"Localidad":"Campo el Brasil","POB1":19,"POB42":9,"POB84":10,"EDU28":0,"EDU34":3,"ECO1":7,"ECO7":0,"ECO13":0,"ECO28":5,"AFRO1":1,"DISC4":0,"DISC5":0,"DISC6":0,"SALUD1":19,"SALUD2":0,"SALUD3":1,"SALUD4":4,"SALUD6":0,"VIV0":13,"VIV7":0,"VIV10":1,"VIV27":5,"VIV28":3,"VIV29":2,"VIV81":0,"VIV15":5,"VIV17":4,"VIV20":5,"VIV34":3,"VIV35":1,"VIV36":3,"GM_2020_y":"Muy bajo","Latitud":18.626702,"Longitud":-98.995352},
            {"CVEGEO":170040028,"Municipio":"Ayala","Poligono":3,"Localidad":"El Vergel","POB1":987,"POB42":483,"POB84":504,"EDU28":74,"EDU34":281,"ECO1":409,"ECO7":28,"ECO13":30,"ECO28":355,"AFRO1":5,"DISC4":4,"DISC5":38,"DISC6":56,"SALUD1":856,"SALUD2":131,"SALUD3":185,"SALUD4":3,"SALUD6":0,"VIV0":368,"VIV7":6,"VIV10":69,"VIV27":225,"VIV28":151,"VIV29":90,"VIV81":41,"VIV15":268,"VIV17":241,"VIV20":249,"VIV34":30,"VIV35":144,"VIV36":149,"GM_2020_y":"Bajo","Latitud":18.59011378,"Longitud":-99.03458552},
            {"CVEGEO":170060114,"Municipio":"Cuautla","Poligono":4,"Localidad":"Campo Carrizal","POB1":13,"POB42":6,"POB84":7,"EDU28":0,"EDU34":7,"ECO1":7,"ECO7":0,"ECO13":1,"ECO28":1,"AFRO1":0,"DISC4":1,"DISC5":0,"DISC6":0,"SALUD1":6,"SALUD2":7,"SALUD3":1,"SALUD4":0,"SALUD6":0,"VIV0":6,"VIV7":0,"VIV10":2,"VIV27":2,"VIV28":1,"VIV29":0,"VIV81":3,"VIV15":3,"VIV17":0,"VIV20":2,"VIV34":1,"VIV35":0,"VIV36":2,"GM_2020_y":"Alto","Latitud":18.778763,"Longitud":-98.905898},
            {"CVEGEO":170060136,"Municipio":"Cuautla","Poligono":4,"Localidad":"Ampliaci√≥n Iztacc√≠huatl","POB1":191,"POB42":95,"POB84":96,"EDU28":6,"EDU34":59,"ECO1":104,"ECO7":6,"ECO13":6,"ECO28":44,"AFRO1":5,"DISC4":0,"DISC5":4,"DISC6":5,"SALUD1":93,"SALUD2":98,"SALUD3":35,"SALUD4":7,"SALUD6":0,"VIV0":72,"VIV7":6,"VIV10":16,"VIV27":43,"VIV28":27,"VIV29":16,"VIV81":7,"VIV15":46,"VIV17":39,"VIV20":43,"VIV34":11,"VIV35":8,"VIV36":42,"GM_2020_y":"Bajo","Latitud":18.794451,"Longitud":-98.909058},
            {"CVEGEO":170080036,"Municipio":"Emiliano Zapata","Poligono":5,"Localidad":"Campo el √ìrgano","POB1":369,"POB42":192,"POB84":177,"EDU28":20,"EDU34":101,"ECO1":188,"ECO7":21,"ECO13":15,"ECO28":94,"AFRO1":4,"DISC4":7,"DISC5":10,"DISC6":11,"SALUD1":250,"SALUD2":119,"SALUD3":105,"SALUD4":2,"SALUD6":2,"VIV0":149,"VIV7":9,"VIV10":43,"VIV27":93,"VIV28":50,"VIV29":21,"VIV81":30,"VIV15":100,"VIV17":96,"VIV20":97,"VIV34":17,"VIV35":31,"VIV36":89,"GM_2020_y":"Bajo","Latitud":18.830511,"Longitud":-99.175174},
            {"CVEGEO":170080045,"Municipio":"Emiliano Zapata","Poligono":5,"Localidad":"Puente Colorado (Campo la Palma)","POB1":14,"POB42":5,"POB84":9,"EDU28":2,"EDU34":5,"ECO1":10,"ECO7":1,"ECO13":2,"ECO28":2,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":1,"SALUD1":6,"SALUD2":8,"SALUD3":2,"SALUD4":0,"SALUD6":0,"VIV0":10,"VIV7":2,"VIV10":2,"VIV27":0,"VIV28":1,"VIV29":1,"VIV81":2,"VIV15":4,"VIV17":0,"VIV20":1,"VIV34":2,"VIV35":0,"VIV36":5,"GM_2020_y":"Muy alto","Latitud":18.8332,"Longitud":-99.172564},
            {"CVEGEO":170080057,"Municipio":"Emiliano Zapata","Poligono":5,"Localidad":"Colonia Modesto Rangel","POB1":345,"POB42":173,"POB84":172,"EDU28":16,"EDU34":97,"ECO1":182,"ECO7":11,"ECO13":11,"ECO28":79,"AFRO1":3,"DISC4":3,"DISC5":8,"DISC6":6,"SALUD1":252,"SALUD2":93,"SALUD3":57,"SALUD4":2,"SALUD6":0,"VIV0":125,"VIV7":12,"VIV10":36,"VIV27":86,"VIV28":44,"VIV29":34,"VIV81":43,"VIV15":96,"VIV17":91,"VIV20":87,"VIV34":15,"VIV35":14,"VIV36":85,"GM_2020_y":"Bajo","Latitud":18.827052,"Longitud":-99.179111},
            {"CVEGEO":170080072,"Municipio":"Emiliano Zapata","Poligono":5,"Localidad":"Ojo de Agua","POB1":60,"POB42":30,"POB84":30,"EDU28":4,"EDU34":14,"ECO1":33,"ECO7":6,"ECO13":2,"ECO28":9,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":0,"SALUD1":38,"SALUD2":22,"SALUD3":6,"SALUD4":0,"SALUD6":0,"VIV0":17,"VIV7":2,"VIV10":8,"VIV27":4,"VIV28":2,"VIV29":5,"VIV81":2,"VIV15":5,"VIV17":4,"VIV20":9,"VIV34":2,"VIV35":1,"VIV36":12,"GM_2020_y":"Muy alto","Latitud":18.820106,"Longitud":-99.165582},
            {"CVEGEO":170090097,"Municipio":"Huitzilac","Poligono":6,"Localidad":"Los Hongos","POB1":108,"POB42":49,"POB84":59,"EDU28":8,"EDU34":27,"ECO1":54,"ECO7":7,"ECO13":5,"ECO28":22,"AFRO1":11,"DISC4":1,"DISC5":2,"DISC6":4,"SALUD1":37,"SALUD2":71,"SALUD3":10,"SALUD4":9,"SALUD6":0,"VIV0":54,"VIV7":7,"VIV10":11,"VIV27":17,"VIV28":20,"VIV29":10,"VIV81":2,"VIV15":32,"VIV17":4,"VIV20":30,"VIV34":2,"VIV35":0,"VIV36":26,"GM_2020_y":"Alto","Latitud":19.063069,"Longitud":-99.238079},
            {"CVEGEO":170090098,"Municipio":"Huitzilac","Poligono":6,"Localidad":"Barrio Tezoyo (El Cuartel)","POB1":202,"POB42":101,"POB84":101,"EDU28":2,"EDU34":29,"ECO1":106,"ECO7":1,"ECO13":5,"ECO28":52,"AFRO1":0,"DISC4":1,"DISC5":6,"DISC6":3,"SALUD1":141,"SALUD2":61,"SALUD3":46,"SALUD4":23,"SALUD6":2,"VIV0":75,"VIV7":1,"VIV10":18,"VIV27":32,"VIV28":36,"VIV29":18,"VIV81":4,"VIV15":52,"VIV17":33,"VIV20":49,"VIV34":12,"VIV35":8,"VIV36":48,"GM_2020_y":"Bajo","Latitud":19.061796,"Longitud":-99.240149},
            {"CVEGEO":170090099,"Municipio":"Huitzilac","Poligono":6,"Localidad":"Colonia Antonio Segura","POB1":121,"POB42":60,"POB84":61,"EDU28":3,"EDU34":29,"ECO1":69,"ECO7":4,"ECO13":6,"ECO28":25,"AFRO1":0,"DISC4":0,"DISC5":10,"DISC6":4,"SALUD1":91,"SALUD2":30,"SALUD3":20,"SALUD4":24,"SALUD6":3,"VIV0":61,"VIV7":3,"VIV10":12,"VIV27":12,"VIV28":12,"VIV29":10,"VIV81":3,"VIV15":31,"VIV17":7,"VIV20":25,"VIV34":6,"VIV35":5,"VIV36":26,"GM_2020_y":"Medio","Latitud":19.053758,"Longitud":-99.235942},
            {"CVEGEO":170090050,"Municipio":"Huitzilac","Poligono":6,"Localidad":"Lagunita","POB1":82,"POB42":38,"POB84":44,"EDU28":6,"EDU34":18,"ECO1":36,"ECO7":1,"ECO13":5,"ECO28":30,"AFRO1":0,"DISC4":1,"DISC5":5,"DISC6":0,"SALUD1":55,"SALUD2":27,"SALUD3":5,"SALUD4":4,"SALUD6":0,"VIV0":30,"VIV7":1,"VIV10":8,"VIV27":7,"VIV28":7,"VIV29":9,"VIV81":1,"VIV15":20,"VIV17":16,"VIV20":19,"VIV34":4,"VIV35":3,"VIV36":18,"GM_2020_y":"Medio","Latitud":19.06260555,"Longitud":-99.24964178},
            {"CVEGEO":170110069,"Municipio":"Jiutepec","Poligono":7,"Localidad":"Colonia Loma Bonita","POB1":360,"POB42":161,"POB84":199,"EDU28":20,"EDU34":102,"ECO1":222,"ECO7":28,"ECO13":17,"ECO28":66,"AFRO1":4,"DISC4":2,"DISC5":3,"DISC6":12,"SALUD1":207,"SALUD2":153,"SALUD3":107,"SALUD4":6,"SALUD6":2,"VIV0":225,"VIV7":48,"VIV10":38,"VIV27":74,"VIV28":33,"VIV29":33,"VIV81":15,"VIV15":106,"VIV17":27,"VIV20":89,"VIV34":13,"VIV35":17,"VIV36":96,"GM_2020_y":"Alto","Latitud":18.870146,"Longitud":-99.147096},
            {"CVEGEO":170110072,"Municipio":"Jiutepec","Poligono":7,"Localidad":"Colonia Luis Donaldo Colosio","POB1":135,"POB42":75,"POB84":60,"EDU28":8,"EDU34":36,"ECO1":43,"ECO7":1,"ECO13":0,"ECO28":54,"AFRO1":0,"DISC4":0,"DISC5":2,"DISC6":0,"SALUD1":62,"SALUD2":73,"SALUD3":26,"SALUD4":1,"SALUD6":0,"VIV0":57,"VIV7":3,"VIV10":11,"VIV27":28,"VIV28":19,"VIV29":10,"VIV81":0,"VIV15":32,"VIV17":31,"VIV20":29,"VIV34":4,"VIV35":9,"VIV36":25,"GM_2020_y":"Bajo","Latitud":18.881877,"Longitud":-99.132808},
            {"CVEGEO":170110078,"Municipio":"Jiutepec","Poligono":7,"Localidad":"Lomas de Chapultepec","POB1":172,"POB42":76,"POB84":96,"EDU28":9,"EDU34":34,"ECO1":79,"ECO7":4,"ECO13":4,"ECO28":54,"AFRO1":9,"DISC4":0,"DISC5":3,"DISC6":4,"SALUD1":98,"SALUD2":71,"SALUD3":38,"SALUD4":3,"SALUD6":1,"VIV0":66,"VIV7":3,"VIV10":20,"VIV27":44,"VIV28":21,"VIV29":15,"VIV81":4,"VIV15":49,"VIV17":46,"VIV20":44,"VIV34":9,"VIV35":10,"VIV36":45,"GM_2020_y":"Bajo","Latitud":18.876027,"Longitud":-99.13486},
            {"CVEGEO":170110083,"Municipio":"Jiutepec","Poligono":7,"Localidad":"Ampliaci√≥n Chapultepec","POB1":116,"POB42":60,"POB84":56,"EDU28":6,"EDU34":37,"ECO1":67,"ECO7":4,"ECO13":7,"ECO28":13,"AFRO1":0,"DISC4":2,"DISC5":2,"DISC6":2,"SALUD1":69,"SALUD2":46,"SALUD3":26,"SALUD4":0,"SALUD6":0,"VIV0":40,"VIV7":7,"VIV10":12,"VIV27":31,"VIV28":16,"VIV29":14,"VIV81":5,"VIV15":32,"VIV17":13,"VIV20":29,"VIV34":5,"VIV35":8,"VIV36":27,"GM_2020_y":"Medio","Latitud":18.870844,"Longitud":-99.141971},
            {"CVEGEO":170110084,"Municipio":"Jiutepec","Poligono":7,"Localidad":"Cerro de la Corona","POB1":233,"POB42":129,"POB84":104,"EDU28":16,"EDU34":51,"ECO1":113,"ECO7":17,"ECO13":5,"ECO28":65,"AFRO1":3,"DISC4":1,"DISC5":3,"DISC6":3,"SALUD1":158,"SALUD2":75,"SALUD3":73,"SALUD4":2,"SALUD6":0,"VIV0":68,"VIV7":4,"VIV10":22,"VIV27":48,"VIV28":26,"VIV29":13,"VIV81":0,"VIV15":53,"VIV17":53,"VIV20":48,"VIV34":7,"VIV35":12,"VIV36":50,"GM_2020_y":"Bajo","Latitud":18.883976,"Longitud":-99.13659},
            {"CVEGEO":170120002,"Municipio":"Jojutla","Poligono":8,"Localidad":"Chisco","POB1":516,"POB42":250,"POB84":266,"EDU28":41,"EDU34":104,"ECO1":203,"ECO7":29,"ECO13":7,"ECO28":202,"AFRO1":0,"DISC4":6,"DISC5":25,"DISC6":39,"SALUD1":395,"SALUD2":121,"SALUD3":64,"SALUD4":26,"SALUD6":17,"VIV0":241,"VIV7":13,"VIV10":46,"VIV27":132,"VIV28":78,"VIV29":45,"VIV81":19,"VIV15":151,"VIV17":150,"VIV20":142,"VIV34":14,"VIV35":34,"VIV36":117,"GM_2020_y":"Bajo","Latitud":18.548565,"Longitud":-99.235304},
            {"CVEGEO":170120009,"Municipio":"Jojutla","Poligono":8,"Localidad":"R√≠o Seco","POB1":238,"POB42":126,"POB84":112,"EDU28":22,"EDU34":42,"ECO1":89,"ECO7":24,"ECO13":2,"ECO28":93,"AFRO1":0,"DISC4":3,"DISC5":6,"DISC6":17,"SALUD1":204,"SALUD2":34,"SALUD3":25,"SALUD4":0,"SALUD6":0,"VIV0":131,"VIV7":8,"VIV10":13,"VIV27":69,"VIV28":53,"VIV29":26,"VIV81":7,"VIV15":74,"VIV17":75,"VIV20":70,"VIV34":3,"VIV35":28,"VIV36":59,"GM_2020_y":"Bajo","Latitud":18.567643,"Longitud":-99.244183},
            {"CVEGEO":170120014,"Municipio":"Jojutla","Poligono":8,"Localidad":"Vicente Aranda (San Rafael)","POB1":335,"POB42":161,"POB84":174,"EDU28":15,"EDU34":85,"ECO1":127,"ECO7":10,"ECO13":6,"ECO28":133,"AFRO1":0,"DISC4":2,"DISC5":26,"DISC6":47,"SALUD1":247,"SALUD2":88,"SALUD3":52,"SALUD4":0,"SALUD6":3,"VIV0":159,"VIV7":5,"VIV10":32,"VIV27":93,"VIV28":65,"VIV29":31,"VIV81":7,"VIV15":102,"VIV17":102,"VIV20":93,"VIV34":8,"VIV35":40,"VIV36":71,"GM_2020_y":"Bajo","Latitud":18.561006,"Longitud":-99.238213},
            {"CVEGEO":170130019,"Municipio":"Jonacatepec de Leandro Valle","Poligono":9,"Localidad":"El Puente Colorado","POB1":40,"POB42":18,"POB84":22,"EDU28":3,"EDU34":12,"ECO1":24,"ECO7":0,"ECO13":1,"ECO28":11,"AFRO1":0,"DISC4":0,"DISC5":2,"DISC6":3,"SALUD1":37,"SALUD2":3,"SALUD3":7,"SALUD4":1,"SALUD6":1,"VIV0":36,"VIV7":1,"VIV10":2,"VIV27":11,"VIV28":6,"VIV29":7,"VIV81":5,"VIV15":12,"VIV17":10,"VIV20":10,"VIV34":2,"VIV35":0,"VIV36":13,"GM_2020_y":"Bajo","Latitud":18.65637067,"Longitud":-98.78643375},
            {"CVEGEO":170130051,"Municipio":"Jonacatepec de Leandro Valle","Poligono":9,"Localidad":"Tetelilla","POB1":9,"POB42":6,"POB84":3,"EDU28":2,"EDU34":3,"ECO1":2,"ECO7":1,"ECO13":0,"ECO28":6,"AFRO1":0,"DISC4":0,"DISC5":1,"DISC6":1,"SALUD1":9,"SALUD2":0,"SALUD3":0,"SALUD4":0,"SALUD6":0,"VIV0":4,"VIV7":0,"VIV10":1,"VIV27":2,"VIV28":2,"VIV29":0,"VIV81":2,"VIV15":3,"VIV17":3,"VIV20":0,"VIV34":0,"VIV35":0,"VIV36":1,"GM_2020_y":"Alto","Latitud":18.612861,"Longitud":-98.766259},
            {"CVEGEO":170130053,"Municipio":"Jonacatepec de Leandro Valle","Poligono":9,"Localidad":"Colonia San Mart√≠n","POB1":41,"POB42":22,"POB84":19,"EDU28":0,"EDU34":11,"ECO1":19,"ECO7":0,"ECO13":3,"ECO28":8,"AFRO1":0,"DISC4":0,"DISC5":1,"DISC6":0,"SALUD1":40,"SALUD2":1,"SALUD3":0,"SALUD4":0,"SALUD6":0,"VIV0":14,"VIV7":1,"VIV10":6,"VIV27":7,"VIV28":2,"VIV29":2,"VIV81":7,"VIV15":10,"VIV17":8,"VIV20":6,"VIV34":0,"VIV35":0,"VIV36":9,"GM_2020_y":"Medio","Latitud":18.618274,"Longitud":-98.778598},
            {"CVEGEO":170130019,"Municipio":"Jonacatepec de Leandro Valle","Poligono":9,"Localidad":"El Puente Colorado","POB1":40,"POB42":18,"POB84":22,"EDU28":3,"EDU34":12,"ECO1":24,"ECO7":0,"ECO13":1,"ECO28":11,"AFRO1":0,"DISC4":0,"DISC5":2,"DISC6":3,"SALUD1":37,"SALUD2":3,"SALUD3":7,"SALUD4":1,"SALUD6":1,"VIV0":36,"VIV7":1,"VIV10":2,"VIV27":11,"VIV28":6,"VIV29":7,"VIV81":5,"VIV15":12,"VIV17":10,"VIV20":10,"VIV34":2,"VIV35":0,"VIV36":13,"GM_2020_y":"Bajo","Latitud":18.6418027,"Longitud":-98.78414654},
            {"CVEGEO":170180029,"Municipio":"Temixco","Poligono":10,"Localidad":"Campo Santa Cruz (La Joya)","POB1":15,"POB42":6,"POB84":9,"EDU28":0,"EDU34":6,"ECO1":4,"ECO7":0,"ECO13":0,"ECO28":7,"AFRO1":0,"DISC4":1,"DISC5":0,"DISC6":2,"SALUD1":14,"SALUD2":1,"SALUD3":2,"SALUD4":0,"SALUD6":0,"VIV0":7,"VIV7":1,"VIV10":3,"VIV27":1,"VIV28":0,"VIV29":1,"VIV81":0,"VIV15":3,"VIV17":1,"VIV20":1,"VIV34":0,"VIV35":0,"VIV36":3,"GM_2020_y":"Alto","Latitud":18.83303,"Longitud":-99.217955},
            {"CVEGEO":170180030,"Municipio":"Temixco","Poligono":10,"Localidad":"Campo Sotelo","POB1":1379,"POB42":732,"POB84":647,"EDU28":38,"EDU34":117,"ECO1":720,"ECO7":22,"ECO13":17,"ECO28":398,"AFRO1":198,"DISC4":12,"DISC5":45,"DISC6":41,"SALUD1":953,"SALUD2":426,"SALUD3":503,"SALUD4":198,"SALUD6":8,"VIV0":1515,"VIV7":9,"VIV10":59,"VIV27":442,"VIV28":339,"VIV29":300,"VIV81":74,"VIV15":458,"VIV17":454,"VIV20":446,"VIV34":263,"VIV35":181,"VIV36":443,"GM_2020_y":"Muy bajo","Latitud":18.835668,"Longitud":-99.214268},
            {"CVEGEO":170180052,"Municipio":"Temixco","Poligono":10,"Localidad":"Campo las Martinicas (Las Higueras)","POB1":40,"POB42":19,"POB84":21,"EDU28":5,"EDU34":6,"ECO1":18,"ECO7":4,"ECO13":0,"ECO28":12,"AFRO1":23,"DISC4":0,"DISC5":1,"DISC6":0,"SALUD1":21,"SALUD2":19,"SALUD3":2,"SALUD4":3,"SALUD6":0,"VIV0":14,"VIV7":3,"VIV10":4,"VIV27":6,"VIV28":3,"VIV29":4,"VIV81":4,"VIV15":8,"VIV17":7,"VIV20":7,"VIV34":1,"VIV35":0,"VIV36":9,"GM_2020_y":"Alto","Latitud":18.824019,"Longitud":-99.210747},
            {"CVEGEO":170180070,"Municipio":"Temixco","Poligono":10,"Localidad":"Colonia Miguel Hidalgo","POB1":565,"POB42":308,"POB84":257,"EDU28":12,"EDU34":60,"ECO1":310,"ECO7":7,"ECO13":5,"ECO28":163,"AFRO1":0,"DISC4":0,"DISC5":6,"DISC6":14,"SALUD1":421,"SALUD2":144,"SALUD3":256,"SALUD4":63,"SALUD6":0,"VIV0":484,"VIV7":0,"VIV10":17,"VIV27":175,"VIV28":139,"VIV29":118,"VIV81":19,"VIV15":178,"VIV17":180,"VIV20":177,"VIV34":107,"VIV35":82,"VIV36":177,"GM_2020_y":"Muy bajo","Latitud":18.841751,"Longitud":-99.21511},
            {"CVEGEO":170190008,"Municipio":"Tepalcingo","Poligono":11,"Localidad":"Pitzotl√°n","POB1":43,"POB42":16,"POB84":27,"EDU28":3,"EDU34":11,"ECO1":28,"ECO7":4,"ECO13":1,"ECO28":6,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":1,"SALUD1":38,"SALUD2":5,"SALUD3":3,"SALUD4":1,"SALUD6":0,"VIV0":25,"VIV7":3,"VIV10":3,"VIV27":0,"VIV28":0,"VIV29":8,"VIV81":0,"VIV15":1,"VIV17":16,"VIV20":11,"VIV34":1,"VIV35":0,"VIV36":14,"GM_2020_y":"Alto","Latitud":18.586937,"Longitud":-98.893014},
            {"CVEGEO":170190019,"Municipio":"Tepalcingo","Poligono":11,"Localidad":"Rancho el Bamb√∫ (La Presa)","POB1":32,"POB42":18,"POB84":14,"EDU28":4,"EDU34":7,"ECO1":16,"ECO7":2,"ECO13":0,"ECO28":8,"AFRO1":0,"DISC4":1,"DISC5":0,"DISC6":0,"SALUD1":29,"SALUD2":3,"SALUD3":0,"SALUD4":0,"SALUD6":0,"VIV0":9,"VIV7":0,"VIV10":3,"VIV27":4,"VIV28":3,"VIV29":1,"VIV81":1,"VIV15":5,"VIV17":4,"VIV20":4,"VIV34":1,"VIV35":0,"VIV36":4,"GM_2020_y":"Alto","Latitud":18.586967,"Longitud":-98.830795},
            {"CVEGEO":170190031,"Municipio":"Tepalcingo","Poligono":11,"Localidad":"Colonia Buenos Aires","POB1":46,"POB42":21,"POB84":25,"EDU28":3,"EDU34":17,"ECO1":25,"ECO7":2,"ECO13":0,"ECO28":12,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":0,"SALUD1":31,"SALUD2":15,"SALUD3":2,"SALUD4":2,"SALUD6":0,"VIV0":34,"VIV7":6,"VIV10":5,"VIV27":7,"VIV28":5,"VIV29":4,"VIV81":7,"VIV15":14,"VIV17":12,"VIV20":12,"VIV34":0,"VIV35":0,"VIV36":14,"GM_2020_y":"Medio","Latitud":18.583739,"Longitud":-98.845695},
            {"CVEGEO":170190043,"Municipio":"Tepalcingo","Poligono":11,"Localidad":"Colonia Emiliano Zapata","POB1":29,"POB42":13,"POB84":16,"EDU28":2,"EDU34":13,"ECO1":12,"ECO7":1,"ECO13":0,"ECO28":10,"AFRO1":0,"DISC4":0,"DISC5":1,"DISC6":0,"SALUD1":21,"SALUD2":8,"SALUD3":2,"SALUD4":1,"SALUD6":0,"VIV0":17,"VIV7":1,"VIV10":5,"VIV27":1,"VIV28":4,"VIV29":2,"VIV81":2,"VIV15":7,"VIV17":7,"VIV20":5,"VIV34":0,"VIV35":0,"VIV36":8,"GM_2020_y":"Alto","Latitud":18.588799,"Longitud":-98.854231},
            {"CVEGEO":170190051,"Municipio":"Tepalcingo","Poligono":11,"Localidad":"La Joya","POB1":20,"POB42":8,"POB84":12,"EDU28":3,"EDU34":10,"ECO1":8,"ECO7":0,"ECO13":1,"ECO28":9,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":3,"SALUD1":13,"SALUD2":7,"SALUD3":2,"SALUD4":0,"SALUD6":0,"VIV0":9,"VIV7":3,"VIV10":1,"VIV27":1,"VIV28":2,"VIV29":1,"VIV81":1,"VIV15":6,"VIV17":5,"VIV20":5,"VIV34":0,"VIV35":0,"VIV36":3,"GM_2020_y":"Alto","Latitud":18.588022,"Longitud":-98.839349},
            {"CVEGEO":170220012,"Municipio":"Tetela del Volcan","Poligono":12,"Localidad":"El Malinal","POB1":29,"POB42":15,"POB84":14,"EDU28":3,"EDU34":9,"ECO1":19,"ECO7":4,"ECO13":1,"ECO28":0,"AFRO1":0,"DISC4":1,"DISC5":1,"DISC6":0,"SALUD1":28,"SALUD2":1,"SALUD3":0,"SALUD4":0,"SALUD6":0,"VIV0":8,"VIV7":5,"VIV10":5,"VIV27":3,"VIV28":2,"VIV29":2,"VIV81":0,"VIV15":8,"VIV17":8,"VIV20":3,"VIV34":0,"VIV35":0,"VIV36":4,"GM_2020_y":"Alto","Latitud":18.907641,"Longitud":-98.728682},
            {"CVEGEO":170240002,"Municipio":"Tlaltizapan de Zapata","Poligono":13,"Localidad":"Acamilpa","POB1":1885,"POB42":961,"POB84":924,"EDU28":103,"EDU34":360,"ECO1":796,"ECO7":34,"ECO13":19,"ECO28":729,"AFRO1":11,"DISC4":6,"DISC5":44,"DISC6":96,"SALUD1":1533,"SALUD2":352,"SALUD3":804,"SALUD4":88,"SALUD6":6,"VIV0":751,"VIV7":29,"VIV10":136,"VIV27":497,"VIV28":365,"VIV29":197,"VIV81":59,"VIV15":554,"VIV17":553,"VIV20":540,"VIV34":136,"VIV35":242,"VIV36":451,"GM_2020_y":"Muy bajo","Latitud":18.715474,"Longitud":-99.159442},
            {"CVEGEO":170240080,"Municipio":"Tlaltizapan de Zapata","Poligono":13,"Localidad":"Colonia Francisco Javier Mina","POB1":38,"POB42":20,"POB84":18,"EDU28":4,"EDU34":10,"ECO1":16,"ECO7":2,"ECO13":0,"ECO28":15,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":1,"SALUD1":34,"SALUD2":4,"SALUD3":9,"SALUD4":4,"SALUD6":0,"VIV0":38,"VIV7":2,"VIV10":3,"VIV27":1,"VIV28":2,"VIV29":3,"VIV81":0,"VIV15":4,"VIV17":13,"VIV20":8,"VIV34":0,"VIV35":0,"VIV36":11,"GM_2020_y":"Alto","Latitud":18.711297,"Longitud":-99.136884},
            {"CVEGEO":170240084,"Municipio":"Tlaltizapan de Zapata","Poligono":13,"Localidad":"El Texcal","POB1":54,"POB42":24,"POB84":30,"EDU28":2,"EDU34":12,"ECO1":26,"ECO7":2,"ECO13":2,"ECO28":10,"AFRO1":0,"DISC4":0,"DISC5":2,"DISC6":0,"SALUD1":38,"SALUD2":16,"SALUD3":3,"SALUD4":0,"SALUD6":0,"VIV0":13,"VIV7":4,"VIV10":8,"VIV27":9,"VIV28":2,"VIV29":4,"VIV81":5,"VIV15":11,"VIV17":1,"VIV20":8,"VIV34":1,"VIV35":0,"VIV36":10,"GM_2020_y":"Alto","Latitud":18.714769,"Longitud":-99.161939},
            {"CVEGEO":170240010,"Municipio":"Tlaltizapan de Zapata","Poligono":13,"Localidad":"Pueblo Nuevo","POB1":1280,"POB42":636,"POB84":644,"EDU28":39,"EDU34":222,"ECO1":616,"ECO7":16,"ECO13":22,"ECO28":424,"AFRO1":2,"DISC4":10,"DISC5":30,"DISC6":56,"SALUD1":1003,"SALUD2":277,"SALUD3":560,"SALUD4":62,"SALUD6":19,"VIV0":449,"VIV7":17,"VIV10":86,"VIV27":338,"VIV28":221,"VIV29":136,"VIV81":39,"VIV15":356,"VIV17":346,"VIV20":349,"VIV34":92,"VIV35":125,"VIV36":306,"GM_2020_y":"Muy bajo","Latitud":18.70040443,"Longitud":-99.15200065},
            {"CVEGEO":170250012,"Municipio":"Tlaquiltenango","Poligono":14,"Localidad":"Lorenzo V√°zquez (Santa Cruz)","POB1":837,"POB42":429,"POB84":408,"EDU28":64,"EDU34":238,"ECO1":400,"ECO7":26,"ECO13":16,"ECO28":243,"AFRO1":0,"DISC4":8,"DISC5":12,"DISC6":27,"SALUD1":715,"SALUD2":122,"SALUD3":127,"SALUD4":7,"SALUD6":2,"VIV0":344,"VIV7":10,"VIV10":74,"VIV27":219,"VIV28":118,"VIV29":73,"VIV81":35,"VIV15":240,"VIV17":210,"VIV20":214,"VIV34":19,"VIV35":112,"VIV36":139,"GM_2020_y":"Bajo","Latitud":18.573944,"Longitud":-99.073561},
            {"CVEGEO":170250038,"Municipio":"Tlaquiltenango","Poligono":14,"Localidad":"Los Dormidos","POB1":38,"POB42":17,"POB84":21,"EDU28":3,"EDU34":11,"ECO1":20,"ECO7":2,"ECO13":2,"ECO28":10,"AFRO1":0,"DISC4":0,"DISC5":1,"DISC6":0,"SALUD1":29,"SALUD2":9,"SALUD3":1,"SALUD4":0,"SALUD6":0,"VIV0":17,"VIV7":6,"VIV10":5,"VIV27":3,"VIV28":1,"VIV29":2,"VIV81":1,"VIV15":10,"VIV17":7,"VIV20":8,"VIV34":0,"VIV35":0,"VIV36":9,"GM_2020_y":"Alto","Latitud":18.60427,"Longitud":-99.079036},
            {"CVEGEO":170260006,"Municipio":"Tlayacapan","Poligono":15,"Localidad":"Nacatongo","POB1":1136,"POB42":571,"POB84":565,"EDU28":54,"EDU34":214,"ECO1":626,"ECO7":53,"ECO13":36,"ECO28":208,"AFRO1":37,"DISC4":11,"DISC5":46,"DISC6":24,"SALUD1":824,"SALUD2":312,"SALUD3":128,"SALUD4":41,"SALUD6":3,"VIV0":378,"VIV7":18,"VIV10":139,"VIV27":237,"VIV28":159,"VIV29":90,"VIV81":35,"VIV15":307,"VIV17":292,"VIV20":277,"VIV34":61,"VIV35":62,"VIV36":266,"GM_2020_y":"Bajo","Latitud":18.946595,"Longitud":-98.980044},
            {"CVEGEO":170260017,"Municipio":"Tlayacapan","Poligono":15,"Localidad":"Colonia Texalo (La Cer√°mica)","POB1":361,"POB42":194,"POB84":167,"EDU28":14,"EDU34":73,"ECO1":197,"ECO7":5,"ECO13":10,"ECO28":100,"AFRO1":3,"DISC4":1,"DISC5":5,"DISC6":10,"SALUD1":244,"SALUD2":113,"SALUD3":67,"SALUD4":25,"SALUD6":0,"VIV0":155,"VIV7":9,"VIV10":34,"VIV27":75,"VIV28":50,"VIV29":43,"VIV81":12,"VIV15":94,"VIV17":93,"VIV20":90,"VIV34":30,"VIV35":31,"VIV36":89,"GM_2020_y":"Muy bajo","Latitud":18.941981,"Longitud":-98.976336},
            {"CVEGEO":170260034,"Municipio":"Tlayacapan","Poligono":15,"Localidad":"Colonia Joyas del Astillero","POB1":93,"POB42":42,"POB84":51,"EDU28":9,"EDU34":26,"ECO1":37,"ECO7":5,"ECO13":1,"ECO28":29,"AFRO1":0,"DISC4":0,"DISC5":1,"DISC6":2,"SALUD1":55,"SALUD2":38,"SALUD3":6,"SALUD4":3,"SALUD6":0,"VIV0":139,"VIV7":7,"VIV10":9,"VIV27":20,"VIV28":9,"VIV29":14,"VIV81":4,"VIV15":23,"VIV17":13,"VIV20":22,"VIV34":6,"VIV35":4,"VIV36":25,"GM_2020_y":"Alto","Latitud":18.938765,"Longitud":-98.950523},
            {"CVEGEO":170260018,"Municipio":"Tlayacapan","Poligono":15,"Localidad":"Colonia 3 de Mayo","POB1":273,"POB42":133,"POB84":140,"EDU28":22,"EDU34":69,"ECO1":100,"ECO7":11,"ECO13":7,"ECO28":91,"AFRO1":0,"DISC4":2,"DISC5":4,"DISC6":2,"SALUD1":200,"SALUD2":73,"SALUD3":2,"SALUD4":11,"SALUD6":0,"VIV0":72,"VIV7":4,"VIV10":31,"VIV27":36,"VIV28":24,"VIV29":23,"VIV81":6,"VIV15":55,"VIV17":42,"VIV20":45,"VIV34":6,"VIV35":7,"VIV36":50,"GM_2020_y":"Medio","Latitud":18.97855611,"Longitud":-98.9651899},
            {"CVEGEO":170280085,"Municipio":"Xochitepec","Poligono":16,"Localidad":"Colonia Loma Bonita","POB1":12,"POB42":5,"POB84":7,"EDU28":0,"EDU34":2,"ECO1":6,"ECO7":0,"ECO13":0,"ECO28":4,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":0,"SALUD1":6,"SALUD2":6,"SALUD3":6,"SALUD4":0,"SALUD6":0,"VIV0":4,"VIV7":0,"VIV10":0,"VIV27":3,"VIV28":3,"VIV29":2,"VIV81":2,"VIV15":3,"VIV17":3,"VIV20":3,"VIV34":0,"VIV35":1,"VIV36":2,"GM_2020_y":"Muy bajo","Latitud":18.812272,"Longitud":-99.267215},
            {"CVEGEO":170280074,"Municipio":"Xochitepec","Poligono":16,"Localidad":"Loma del Tepehuaje","POB1":15,"POB42":7,"POB84":8,"EDU28":0,"EDU34":9,"ECO1":7,"ECO7":0,"ECO13":1,"ECO28":5,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":0,"SALUD1":8,"SALUD2":7,"SALUD3":0,"SALUD4":0,"SALUD6":0,"VIV0":10,"VIV7":1,"VIV10":2,"VIV27":3,"VIV28":1,"VIV29":2,"VIV81":0,"VIV15":3,"VIV17":0,"VIV20":1,"VIV34":1,"VIV35":0,"VIV36":3,"GM_2020_y":"Muy alto","Latitud":18.808304,"Longitud":-99.261274},
            {"CVEGEO":170280075,"Municipio":"Xochitepec","Poligono":16,"Localidad":"Plan de Tlazala","POB1":25,"POB42":11,"POB84":14,"EDU28":2,"EDU34":7,"ECO1":14,"ECO7":3,"ECO13":2,"ECO28":5,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":0,"SALUD1":17,"SALUD2":8,"SALUD3":3,"SALUD4":0,"SALUD6":0,"VIV0":9,"VIV7":1,"VIV10":3,"VIV27":7,"VIV28":3,"VIV29":5,"VIV81":1,"VIV15":7,"VIV17":7,"VIV20":7,"VIV34":1,"VIV35":1,"VIV36":6,"GM_2020_y":"Bajo","Latitud":18.799124,"Longitud":-99.25071},
            {"CVEGEO":170280076,"Municipio":"Xochitepec","Poligono":16,"Localidad":"La Presa","POB1":28,"POB42":10,"POB84":18,"EDU28":6,"EDU34":6,"ECO1":14,"ECO7":7,"ECO13":0,"ECO28":4,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":0,"SALUD1":23,"SALUD2":5,"SALUD3":1,"SALUD4":0,"SALUD6":0,"VIV0":6,"VIV7":1,"VIV10":3,"VIV27":3,"VIV28":0,"VIV29":0,"VIV81":0,"VIV15":4,"VIV17":2,"VIV20":2,"VIV34":0,"VIV35":0,"VIV36":3,"GM_2020_y":"Muy alto","Latitud":18.793698,"Longitud":-99.257271},
            {"CVEGEO":170280111,"Municipio":"Xochitepec","Poligono":16,"Localidad":"Colonia las Flores","POB1":906,"POB42":452,"POB84":454,"EDU28":27,"EDU34":273,"ECO1":446,"ECO7":17,"ECO13":32,"ECO28":248,"AFRO1":46,"DISC4":5,"DISC5":29,"DISC6":13,"SALUD1":540,"SALUD2":364,"SALUD3":149,"SALUD4":22,"SALUD6":6,"VIV0":317,"VIV7":41,"VIV10":110,"VIV27":198,"VIV28":100,"VIV29":72,"VIV81":40,"VIV15":222,"VIV17":197,"VIV20":212,"VIV34":36,"VIV35":43,"VIV36":206,"GM_2020_y":"Bajo","Latitud":18.809918,"Longitud":-99.252455},
            {"CVEGEO":170280073,"Municipio":"Xochitepec","Poligono":16,"Localidad":"Loma el Encanto","POB1":226,"POB42":117,"POB84":109,"EDU28":11,"EDU34":49,"ECO1":117,"ECO7":6,"ECO13":6,"ECO28":44,"AFRO1":4,"DISC4":6,"DISC5":10,"DISC6":7,"SALUD1":156,"SALUD2":70,"SALUD3":54,"SALUD4":4,"SALUD6":2,"VIV0":87,"VIV7":10,"VIV10":27,"VIV27":45,"VIV28":31,"VIV29":25,"VIV81":7,"VIV15":56,"VIV17":44,"VIV20":52,"VIV34":7,"VIV35":6,"VIV36":53,"GM_2020_y":"Medio","Latitud":18.79538362,"Longitud":-99.25043255},
            {"CVEGEO":170290014,"Municipio":"Yautepec","Poligono":17,"Localidad":"San Isidro","POB1":1153,"POB42":599,"POB84":554,"EDU28":69,"EDU34":202,"ECO1":559,"ECO7":29,"ECO13":20,"ECO28":338,"AFRO1":369,"DISC4":5,"DISC5":19,"DISC6":45,"SALUD1":808,"SALUD2":344,"SALUD3":209,"SALUD4":38,"SALUD6":1,"VIV0":525,"VIV7":18,"VIV10":111,"VIV27":282,"VIV28":185,"VIV29":115,"VIV81":21,"VIV15":316,"VIV17":307,"VIV20":306,"VIV34":68,"VIV35":90,"VIV36":281,"GM_2020_y":"Muy bajo","Latitud":18.822442,"Longitud":-99.094012},
            {"CVEGEO":170290117,"Municipio":"Yautepec","Poligono":17,"Localidad":"El Fort√≠n","POB1":208,"POB42":104,"POB84":104,"EDU28":13,"EDU34":71,"ECO1":92,"ECO7":11,"ECO13":3,"ECO28":66,"AFRO1":11,"DISC4":1,"DISC5":5,"DISC6":8,"SALUD1":130,"SALUD2":78,"SALUD3":10,"SALUD4":17,"SALUD6":0,"VIV0":89,"VIV7":13,"VIV10":24,"VIV27":41,"VIV28":17,"VIV29":18,"VIV81":5,"VIV15":49,"VIV17":15,"VIV20":43,"VIV34":3,"VIV35":5,"VIV36":46,"GM_2020_y":"Alto","Latitud":18.825045,"Longitud":-99.104388},
            {"CVEGEO":170290133,"Municipio":"Yautepec","Poligono":17,"Localidad":"Campo la Tehuixtlera","POB1":227,"POB42":114,"POB84":113,"EDU28":15,"EDU34":58,"ECO1":113,"ECO7":11,"ECO13":5,"ECO28":74,"AFRO1":17,"DISC4":2,"DISC5":4,"DISC6":7,"SALUD1":141,"SALUD2":86,"SALUD3":44,"SALUD4":6,"SALUD6":1,"VIV0":140,"VIV7":9,"VIV10":23,"VIV27":49,"VIV28":31,"VIV29":21,"VIV81":10,"VIV15":57,"VIV17":15,"VIV20":61,"VIV34":3,"VIV35":2,"VIV36":57,"GM_2020_y":"Medio","Latitud":18.842899,"Longitud":-99.104523},
            {"CVEGEO":170290172,"Municipio":"Yautepec","Poligono":17,"Localidad":"El Fort√≠n Dos","POB1":52,"POB42":31,"POB84":21,"EDU28":6,"EDU34":19,"ECO1":23,"ECO7":2,"ECO13":0,"ECO28":15,"AFRO1":10,"DISC4":0,"DISC5":2,"DISC6":2,"SALUD1":20,"SALUD2":32,"SALUD3":6,"SALUD4":2,"SALUD6":0,"VIV0":23,"VIV7":4,"VIV10":5,"VIV27":8,"VIV28":3,"VIV29":7,"VIV81":0,"VIV15":14,"VIV17":5,"VIV20":13,"VIV34":0,"VIV35":0,"VIV36":15,"GM_2020_y":"Alto","Latitud":18.831632,"Longitud":-99.105726},
            {"CVEGEO":170300015,"Municipio":"Yecapixtla","Poligono":18,"Localidad":"Texcala","POB1":1812,"POB42":917,"POB84":895,"EDU28":115,"EDU34":402,"ECO1":1038,"ECO7":57,"ECO13":61,"ECO28":339,"AFRO1":10,"DISC4":9,"DISC5":26,"DISC6":39,"SALUD1":1394,"SALUD2":417,"SALUD3":75,"SALUD4":13,"SALUD6":8,"VIV0":584,"VIV7":26,"VIV10":211,"VIV27":249,"VIV28":171,"VIV29":183,"VIV81":118,"VIV15":483,"VIV17":474,"VIV20":401,"VIV34":31,"VIV35":46,"VIV36":424,"GM_2020_y":"Bajo","Latitud":18.934575,"Longitud":-98.796261},
            {"CVEGEO":170300016,"Municipio":"Yecapixtla","Poligono":18,"Localidad":"Tezontetelco","POB1":235,"POB42":122,"POB84":113,"EDU28":16,"EDU34":88,"ECO1":147,"ECO7":7,"ECO13":11,"ECO28":38,"AFRO1":1,"DISC4":2,"DISC5":3,"DISC6":7,"SALUD1":98,"SALUD2":137,"SALUD3":2,"SALUD4":1,"SALUD6":0,"VIV0":90,"VIV7":6,"VIV10":20,"VIV27":46,"VIV28":31,"VIV29":42,"VIV81":24,"VIV15":65,"VIV17":66,"VIV20":54,"VIV34":6,"VIV35":0,"VIV36":63,"GM_2020_y":"Bajo","Latitud":18.931712,"Longitud":-98.810118},
            {"CVEGEO":170300020,"Municipio":"Yecapixtla","Poligono":18,"Localidad":"Los Capulines","POB1":365,"POB42":180,"POB84":185,"EDU28":29,"EDU34":81,"ECO1":190,"ECO7":16,"ECO13":13,"ECO28":79,"AFRO1":0,"DISC4":1,"DISC5":6,"DISC6":4,"SALUD1":239,"SALUD2":126,"SALUD3":3,"SALUD4":4,"SALUD6":0,"VIV0":109,"VIV7":18,"VIV10":48,"VIV27":33,"VIV28":28,"VIV29":32,"VIV81":10,"VIV15":92,"VIV17":11,"VIV20":31,"VIV34":2,"VIV35":0,"VIV36":84,"GM_2020_y":"Alto","Latitud":18.919654,"Longitud":-98.815897},
            {"CVEGEO":170300026,"Municipio":"Yecapixtla","Poligono":18,"Localidad":"Zacahuacatla","POB1":81,"POB42":38,"POB84":43,"EDU28":2,"EDU34":19,"ECO1":59,"ECO7":1,"ECO13":3,"ECO28":5,"AFRO1":0,"DISC4":1,"DISC5":1,"DISC6":1,"SALUD1":58,"SALUD2":23,"SALUD3":2,"SALUD4":3,"SALUD6":0,"VIV0":39,"VIV7":2,"VIV10":8,"VIV27":16,"VIV28":10,"VIV29":14,"VIV81":5,"VIV15":21,"VIV17":21,"VIV20":14,"VIV34":3,"VIV35":0,"VIV36":19,"GM_2020_y":"Bajo","Latitud":18.912821,"Longitud":-98.813228},
            {"CVEGEO":170300031,"Municipio":"Yecapixtla","Poligono":18,"Localidad":"La Hacienda","POB1":75,"POB42":42,"POB84":33,"EDU28":4,"EDU34":20,"ECO1":44,"ECO7":3,"ECO13":1,"ECO28":10,"AFRO1":0,"DISC4":2,"DISC5":0,"DISC6":0,"SALUD1":38,"SALUD2":37,"SALUD3":4,"SALUD4":0,"SALUD6":0,"VIV0":32,"VIV7":2,"VIV10":14,"VIV27":14,"VIV28":5,"VIV29":10,"VIV81":3,"VIV15":19,"VIV17":20,"VIV20":14,"VIV34":2,"VIV35":0,"VIV36":20,"GM_2020_y":"Bajo","Latitud":18.922312,"Longitud":-98.807784},
            {"CVEGEO":170310032,"Municipio":"Zacatepec","Poligono":19,"Localidad":"Ampliaci√≥n Plutarco El√≠as Calles","POB1":21,"POB42":9,"POB84":12,"EDU28":1,"EDU34":10,"ECO1":13,"ECO7":1,"ECO13":2,"ECO28":2,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":0,"SALUD1":4,"SALUD2":17,"SALUD3":2,"SALUD4":0,"SALUD6":0,"VIV0":10,"VIV7":4,"VIV10":1,"VIV27":5,"VIV28":1,"VIV29":1,"VIV81":3,"VIV15":5,"VIV17":5,"VIV20":5,"VIV34":0,"VIV35":0,"VIV36":5,"GM_2020_y":"Medio","Latitud":18.670821,"Longitud":-99.212621},
            {"CVEGEO":170310033,"Municipio":"Zacatepec","Poligono":19,"Localidad":"El Bonete","POB1":31,"POB42":17,"POB84":14,"EDU28":6,"EDU34":7,"ECO1":12,"ECO7":5,"ECO13":0,"ECO28":9,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":0,"SALUD1":27,"SALUD2":4,"SALUD3":1,"SALUD4":0,"SALUD6":2,"VIV0":18,"VIV7":3,"VIV10":3,"VIV27":2,"VIV28":0,"VIV29":0,"VIV81":2,"VIV15":6,"VIV17":1,"VIV20":9,"VIV34":0,"VIV35":0,"VIV36":3,"GM_2020_y":"Muy alto","Latitud":18.673725,"Longitud":-99.197444},
            {"CVEGEO":170330007,"Municipio":"Temoac","Poligono":20,"Localidad":"La Joya [Campo]","POB1":26,"POB42":14,"POB84":12,"EDU28":1,"EDU34":8,"ECO1":13,"ECO7":0,"ECO13":2,"ECO28":10,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":1,"SALUD1":22,"SALUD2":4,"SALUD3":3,"SALUD4":7,"SALUD6":0,"VIV0":12,"VIV7":0,"VIV10":2,"VIV27":5,"VIV28":4,"VIV29":3,"VIV81":2,"VIV15":5,"VIV17":4,"VIV20":5,"VIV34":3,"VIV35":0,"VIV36":5,"GM_2020_y":"Bajo","Latitud":18.781684,"Longitud":-98.788481},
            {"CVEGEO":170330014,"Municipio":"Temoac","Poligono":20,"Localidad":"El Tecorralito","POB1":5,"POB42":2,"POB84":3,"EDU28":0,"EDU34":4,"ECO1":4,"ECO7":1,"ECO13":0,"ECO28":1,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":0,"SALUD1":4,"SALUD2":1,"SALUD3":0,"SALUD4":0,"SALUD6":0,"VIV0":11,"VIV7":0,"VIV10":0,"VIV27":1,"VIV28":0,"VIV29":0,"VIV81":0,"VIV15":1,"VIV17":3,"VIV20":3,"VIV34":0,"VIV35":0,"VIV36":3,"GM_2020_y":"Alto","Latitud":18.777061,"Longitud":-98.792437},
            {"CVEGEO":170330017,"Municipio":"Temoac","Poligono":20,"Localidad":"Barrio San Mart√≠n","POB1":24,"POB42":14,"POB84":10,"EDU28":2,"EDU34":3,"ECO1":9,"ECO7":0,"ECO13":0,"ECO28":6,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":3,"SALUD1":16,"SALUD2":8,"SALUD3":4,"SALUD4":11,"SALUD6":0,"VIV0":8,"VIV7":1,"VIV10":2,"VIV27":6,"VIV28":4,"VIV29":3,"VIV81":1,"VIV15":8,"VIV17":8,"VIV20":8,"VIV34":3,"VIV35":0,"VIV36":7,"GM_2020_y":"Muy bajo","Latitud":18.777527,"Longitud":-98.779047},
            {"CVEGEO":170330020,"Municipio":"Temoac","Poligono":20,"Localidad":"Campo Santa Luc√≠a","POB1":25,"POB42":8,"POB84":17,"EDU28":1,"EDU34":3,"ECO1":13,"ECO7":1,"ECO13":0,"ECO28":4,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":0,"SALUD1":15,"SALUD2":10,"SALUD3":1,"SALUD4":8,"SALUD6":1,"VIV0":16,"VIV7":0,"VIV10":4,"VIV27":7,"VIV28":2,"VIV29":6,"VIV81":0,"VIV15":8,"VIV17":7,"VIV20":8,"VIV34":3,"VIV35":1,"VIV36":8,"GM_2020_y":"Bajo","Latitud":18.762684,"Longitud":-98.779519},
            {"CVEGEO":170330022,"Municipio":"Temoac","Poligono":20,"Localidad":"Barrio San Mart√≠n","POB1":14,"POB42":8,"POB84":6,"EDU28":0,"EDU34":2,"ECO1":8,"ECO7":0,"ECO13":0,"ECO28":3,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":0,"SALUD1":3,"SALUD2":11,"SALUD3":1,"SALUD4":0,"SALUD6":0,"VIV0":7,"VIV7":0,"VIV10":1,"VIV27":3,"VIV28":2,"VIV29":0,"VIV81":3,"VIV15":3,"VIV17":1,"VIV20":2,"VIV34":1,"VIV35":0,"VIV36":3,"GM_2020_y":"Muy bajo","Latitud":18.769856,"Longitud":-98.789247},
            {"CVEGEO":170340003,"Municipio":"Coatetelco","Poligono":21,"Localidad":"Campo el Llanito","POB1":63,"POB42":35,"POB84":28,"EDU28":2,"EDU34":20,"ECO1":39,"ECO7":1,"ECO13":6,"ECO28":11,"AFRO1":7,"DISC4":0,"DISC5":2,"DISC6":0,"SALUD1":48,"SALUD2":15,"SALUD3":5,"SALUD4":1,"SALUD6":0,"VIV0":18,"VIV7":4,"VIV10":7,"VIV27":14,"VIV28":6,"VIV29":5,"VIV81":4,"VIV15":16,"VIV17":12,"VIV20":15,"VIV34":3,"VIV35":2,"VIV36":14,"GM_2020_y":"Bajo","Latitud":18.729847,"Longitud":-99.3359},
            {"CVEGEO":170340004,"Municipio":"Coatetelco","Poligono":21,"Localidad":"Campo la Candelaria","POB1":29,"POB42":16,"POB84":13,"EDU28":0,"EDU34":12,"ECO1":12,"ECO7":0,"ECO13":0,"ECO28":7,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":0,"SALUD1":25,"SALUD2":4,"SALUD3":1,"SALUD4":0,"SALUD6":0,"VIV0":9,"VIV7":2,"VIV10":1,"VIV27":5,"VIV28":1,"VIV29":0,"VIV81":1,"VIV15":7,"VIV17":7,"VIV20":7,"VIV34":0,"VIV35":1,"VIV36":7,"GM_2020_y":"Medio","Latitud":18.735344,"Longitud":-99.332552},
            {"CVEGEO":170340005,"Municipio":"Coatetelco","Poligono":21,"Localidad":"Colonia 3 de Mayo","POB1":221,"POB42":116,"POB84":105,"EDU28":15,"EDU34":82,"ECO1":117,"ECO7":12,"ECO13":9,"ECO28":32,"AFRO1":0,"DISC4":2,"DISC5":1,"DISC6":3,"SALUD1":192,"SALUD2":29,"SALUD3":7,"SALUD4":1,"SALUD6":0,"VIV0":78,"VIV7":23,"VIV10":35,"VIV27":36,"VIV28":5,"VIV29":7,"VIV81":2,"VIV15":51,"VIV17":47,"VIV20":50,"VIV34":2,"VIV35":8,"VIV36":44,"GM_2020_y":"Medio","Latitud":18.73975,"Longitud":-99.326157},
            {"CVEGEO":170340006,"Municipio":"Coatetelco","Poligono":21,"Localidad":"Colonia Benito Ju√°rez","POB1":101,"POB42":53,"POB84":48,"EDU28":7,"EDU34":32,"ECO1":38,"ECO7":7,"ECO13":0,"ECO28":36,"AFRO1":0,"DISC4":0,"DISC5":3,"DISC6":0,"SALUD1":82,"SALUD2":19,"SALUD3":1,"SALUD4":0,"SALUD6":0,"VIV0":36,"VIV7":8,"VIV10":14,"VIV27":14,"VIV28":5,"VIV29":6,"VIV81":0,"VIV15":21,"VIV17":14,"VIV20":16,"VIV34":2,"VIV35":1,"VIV36":20,"GM_2020_y":"Alto","Latitud":18.725195,"Longitud":-99.314661},
            {"CVEGEO":170340007,"Municipio":"Coatetelco","Poligono":21,"Localidad":"Colonia San Isidro","POB1":13,"POB42":8,"POB84":5,"EDU28":1,"EDU34":5,"ECO1":5,"ECO7":1,"ECO13":0,"ECO28":5,"AFRO1":0,"DISC4":0,"DISC5":1,"DISC6":0,"SALUD1":6,"SALUD2":7,"SALUD3":0,"SALUD4":0,"SALUD6":0,"VIV0":15,"VIV7":1,"VIV10":2,"VIV27":4,"VIV28":0,"VIV29":1,"VIV81":1,"VIV15":4,"VIV17":1,"VIV20":4,"VIV34":0,"VIV35":1,"VIV36":4,"GM_2020_y":"Medio","Latitud":18.72163,"Longitud":-99.305718},
            {"CVEGEO":170340012,"Municipio":"Coatetelco","Poligono":21,"Localidad":"General Pedro Saavedra","POB1":338,"POB42":180,"POB84":158,"EDU28":28,"EDU34":107,"ECO1":112,"ECO7":10,"ECO13":7,"ECO28":127,"AFRO1":2,"DISC4":2,"DISC5":4,"DISC6":9,"SALUD1":293,"SALUD2":45,"SALUD3":8,"SALUD4":1,"SALUD6":0,"VIV0":102,"VIV7":13,"VIV10":37,"VIV27":64,"VIV28":16,"VIV29":12,"VIV81":9,"VIV15":79,"VIV17":70,"VIV20":69,"VIV34":5,"VIV35":19,"VIV36":59,"GM_2020_y":"Medio","Latitud":18.738186,"Longitud":-99.326131},
            {"CVEGEO":170340013,"Municipio":"Coatetelco","Poligono":21,"Localidad":"La Cuahulotera","POB1":18,"POB42":9,"POB84":9,"EDU28":2,"EDU34":10,"ECO1":12,"ECO7":1,"ECO13":1,"ECO28":3,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":0,"SALUD1":17,"SALUD2":1,"SALUD3":2,"SALUD4":0,"SALUD6":0,"VIV0":11,"VIV7":2,"VIV10":2,"VIV27":0,"VIV28":0,"VIV29":2,"VIV81":2,"VIV15":2,"VIV17":1,"VIV20":4,"VIV34":0,"VIV35":0,"VIV36":5,"GM_2020_y":"Muy alto","Latitud":18.722094,"Longitud":-99.287751},
            {"CVEGEO":170350006,"Municipio":"Xoxocotla","Poligono":22,"Localidad":"Camino de San Juanes","POB1":19,"POB42":10,"POB84":9,"EDU28":4,"EDU34":8,"ECO1":9,"ECO7":2,"ECO13":1,"ECO28":6,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":2,"SALUD1":16,"SALUD2":3,"SALUD3":2,"SALUD4":0,"SALUD6":0,"VIV0":8,"VIV7":0,"VIV10":3,"VIV27":4,"VIV28":0,"VIV29":1,"VIV81":3,"VIV15":5,"VIV17":2,"VIV20":5,"VIV34":0,"VIV35":1,"VIV36":4,"GM_2020_y":"Alto","Latitud":18.667152,"Longitud":-99.243829},
            {"CVEGEO":170350009,"Municipio":"Xoxocotla","Poligono":22,"Localidad":"Campo los Sauces","POB1":17,"POB42":5,"POB84":12,"EDU28":1,"EDU34":3,"ECO1":10,"ECO7":2,"ECO13":0,"ECO28":6,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":0,"SALUD1":9,"SALUD2":8,"SALUD3":2,"SALUD4":0,"SALUD6":0,"VIV0":19,"VIV7":2,"VIV10":0,"VIV27":4,"VIV28":2,"VIV29":3,"VIV81":1,"VIV15":5,"VIV17":4,"VIV20":5,"VIV34":1,"VIV35":0,"VIV36":3,"GM_2020_y":"Muy bajo","Latitud":18.664559,"Longitud":-99.253969},
            {"CVEGEO":170350010,"Municipio":"Xoxocotla","Poligono":22,"Localidad":"La Pintora","POB1":165,"POB42":79,"POB84":86,"EDU28":15,"EDU34":47,"ECO1":86,"ECO7":6,"ECO13":4,"ECO28":48,"AFRO1":1,"DISC4":1,"DISC5":4,"DISC6":0,"SALUD1":95,"SALUD2":69,"SALUD3":42,"SALUD4":22,"SALUD6":0,"VIV0":70,"VIV7":22,"VIV10":15,"VIV27":35,"VIV28":19,"VIV29":13,"VIV81":12,"VIV15":45,"VIV17":12,"VIV20":44,"VIV34":3,"VIV35":5,"VIV36":33,"GM_2020_y":"Alto","Latitud":18.708168,"Longitud":-99.25268},
            {"CVEGEO":170350015,"Municipio":"Xoxocotla","Poligono":22,"Localidad":"Morelos","POB1":19,"POB42":9,"POB84":10,"EDU28":0,"EDU34":2,"ECO1":9,"ECO7":0,"ECO13":0,"ECO28":5,"AFRO1":4,"DISC4":0,"DISC5":0,"DISC6":0,"SALUD1":19,"SALUD2":0,"SALUD3":5,"SALUD4":1,"SALUD6":0,"VIV0":8,"VIV7":5,"VIV10":4,"VIV27":4,"VIV28":2,"VIV29":1,"VIV81":3,"VIV15":6,"VIV17":2,"VIV20":6,"VIV34":1,"VIV35":0,"VIV36":4,"GM_2020_y":"Alto","Latitud":18.68214,"Longitud":-99.25697},
            {"CVEGEO":170350018,"Municipio":"Xoxocotla","Poligono":22,"Localidad":"El Faro","POB1":21,"POB42":13,"POB84":8,"EDU28":0,"EDU34":6,"ECO1":10,"ECO7":0,"ECO13":0,"ECO28":7,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":1,"SALUD1":15,"SALUD2":6,"SALUD3":1,"SALUD4":0,"SALUD6":0,"VIV0":9,"VIV7":2,"VIV10":2,"VIV27":2,"VIV28":1,"VIV29":1,"VIV81":2,"VIV15":2,"VIV17":1,"VIV20":4,"VIV34":1,"VIV35":0,"VIV36":3,"GM_2020_y":"Alto","Latitud":18.673954,"Longitud":-99.257534},
            {"CVEGEO":170350019,"Municipio":"Xoxocotla","Poligono":22,"Localidad":"F√°brica de M√°rmol (Kil√≥metro 2)","POB1":76,"POB42":36,"POB84":40,"EDU28":8,"EDU34":15,"ECO1":31,"ECO7":3,"ECO13":2,"ECO28":22,"AFRO1":0,"DISC4":0,"DISC5":1,"DISC6":1,"SALUD1":44,"SALUD2":32,"SALUD3":6,"SALUD4":0,"SALUD6":0,"VIV0":21,"VIV7":8,"VIV10":12,"VIV27":10,"VIV28":4,"VIV29":5,"VIV81":3,"VIV15":15,"VIV17":10,"VIV20":13,"VIV34":0,"VIV35":0,"VIV36":11,"GM_2020_y":"Alto","Latitud":18.669814,"Longitud":-99.257522},
            {"CVEGEO":170350026,"Municipio":"Xoxocotla","Poligono":22,"Localidad":"Techichilco","POB1":42,"POB42":17,"POB84":25,"EDU28":4,"EDU34":10,"ECO1":18,"ECO7":3,"ECO13":0,"ECO28":15,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":0,"SALUD1":33,"SALUD2":9,"SALUD3":8,"SALUD4":0,"SALUD6":0,"VIV0":10,"VIV7":5,"VIV10":8,"VIV27":4,"VIV28":0,"VIV29":1,"VIV81":1,"VIV15":9,"VIV17":7,"VIV20":9,"VIV34":0,"VIV35":0,"VIV36":4,"GM_2020_y":"Alto","Latitud":18.685411,"Longitud":-99.235123},
            {"CVEGEO":170360003,"Municipio":"Hueyapan","Poligono":23,"Localidad":"Amialtenco","POB1":26,"POB42":14,"POB84":12,"EDU28":3,"EDU34":9,"ECO1":10,"ECO7":1,"ECO13":0,"ECO28":3,"AFRO1":0,"DISC4":1,"DISC5":1,"DISC6":0,"SALUD1":14,"SALUD2":12,"SALUD3":0,"SALUD4":0,"SALUD6":0,"VIV0":10,"VIV7":0,"VIV10":3,"VIV27":2,"VIV28":3,"VIV29":2,"VIV81":1,"VIV15":6,"VIV17":5,"VIV20":2,"VIV34":0,"VIV35":0,"VIV36":4,"GM_2020_y":"Alto","Latitud":18.86731,"Longitud":-98.708483},
            {"CVEGEO":170360010,"Municipio":"Hueyapan","Poligono":23,"Localidad":"Matlacotla","POB1":45,"POB42":23,"POB84":22,"EDU28":1,"EDU34":17,"ECO1":27,"ECO7":0,"ECO13":4,"ECO28":7,"AFRO1":0,"DISC4":0,"DISC5":0,"DISC6":1,"SALUD1":20,"SALUD2":25,"SALUD3":0,"SALUD4":0,"SALUD6":1,"VIV0":19,"VIV7":4,"VIV10":4,"VIV27":8,"VIV28":4,"VIV29":2,"VIV81":0,"VIV15":11,"VIV17":10,"VIV20":7,"VIV34":1,"VIV35":1,"VIV36":9,"GM_2020_y":"Bajo","Latitud":18.869758,"Longitud":-98.697471}
        ];

        // --- CHART & MAP INSTANCES ---
        let charts = {};
        let map;
        let marker;
        let currentData = null; 

        // --- DOM ELEMENTS ---
        const poligonoFilter = document.getElementById('poligono-filter');
        const localidadFilter = document.getElementById('localidad-filter');
        const eduContainer = document.getElementById('edu-container');
        const ticContainer = document.getElementById('tic-container');
        const demoContainer = document.getElementById('demo-container');
        const healthContainer = document.getElementById('health-container');
        const printButton = document.getElementById('print-button');
        const generateSummaryBtn = document.getElementById('generate-summary');
        const suggestProjectsBtn = document.getElementById('suggest-projects');
        const listenBtn = document.getElementById('listen-button');
        const geminiLoader = document.getElementById('gemini-loader');
        const loaderText = document.getElementById('loader-text');
        const geminiOutput = document.getElementById('gemini-output');

        // --- FUNCTIONS ---

        function initMap() {
            const streetMap = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            });
            const satelliteMap = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
                attribution: 'Tiles &copy; Esri'
            });
            map = L.map('map', {
                center: [18.85, -99.15],
                zoom: 9,
                layers: [streetMap]
            });
            const baseLayers = { "Mapa de Calles": streetMap, "Vista Satelital": satelliteMap };
            L.control.layers(baseLayers).addTo(map);
            marker = L.marker([18.85, -99.15]).addTo(map).bindPopup("Seleccione una localidad.");
        }

        function populatePoligonoFilter() {
            poligonoFilter.innerHTML = '<option value="TODOS">Todos los Pol√≠gonos</option>';
            const poligonos = [...new Set(dataSet.map(item => item.Poligono))].filter(Boolean).sort((a, b) => a - b);
            poligonos.forEach(p => {
                const option = document.createElement('option');
                option.value = p;
                option.textContent = `Pol√≠gono ${p}`;
                poligonoFilter.appendChild(option);
            });
        }
        
        function updateLocalidadFilter() {
            const selectedPoligono = poligonoFilter.value;
            let availableLocalidades;
            if (selectedPoligono === 'TODOS') {
                availableLocalidades = dataSet;
            } else {
                availableLocalidades = dataSet.filter(item => item.Poligono === parseInt(selectedPoligono));
            }
            localidadFilter.innerHTML = '';
            if (availableLocalidades.length > 0) {
                availableLocalidades.forEach(l => {
                    const option = document.createElement('option');
                    option.value = l.CVEGEO;
                    option.textContent = `${l.Localidad} (${l.Municipio})`;
                    localidadFilter.appendChild(option);
                });
            } else {
                localidadFilter.innerHTML = '<option value="">No hay resultados</option>';
            }
            updateDashboard();
        }

        function clearDashboard() {
            currentData = null;
            document.getElementById('info-localidad').textContent = '-';
            document.getElementById('info-municipio').textContent = '-';
            document.getElementById('info-marginacion').textContent = '-';
            map.setView([18.85, -99.15], 9);
            marker.setLatLng([18.85, -99.15]).bindPopup("Seleccione una localidad.");
            document.querySelectorAll('.card-value').forEach(el => el.textContent = '0');
            updateInfoRows(eduContainer, {});
            updateInfoRows(ticContainer, {});
            updateInfoRows(demoContainer, {});
            updateInfoRows(healthContainer, {});
            Object.values(charts).forEach(chart => {
                if (chart) {
                    chart.data.datasets.forEach((dataset) => { dataset.data = []; });
                    chart.update();
                }
            });
        }
        
        function createInfoRow(label, value, color) {
            const displayValue = (value === null || typeof value === 'undefined') ? 'N/D' : value.toLocaleString();
            return `
                <div class="print-info-row flex justify-between items-center border-b border-gray-200 py-2 last:border-b-0">
                    <span class="font-semibold text-gray-500 text-xs uppercase tracking-wider">${label}</span>
                    <span class="font-bold text-xl" style="color: ${color};">${displayValue}</span>
                </div>`;
        }
        
        function updateInfoRows(container, data, mapping) {
            container.innerHTML = Object.entries(mapping).map(([label, { key, color }]) => {
                return createInfoRow(label, data[key], color);
            }).join('');
        }

        function updateDashboard() {
            const selectedCvegeo = parseInt(localidadFilter.value);
            currentData = dataSet.find(item => item.CVEGEO === selectedCvegeo);

            if (!currentData) {
                clearDashboard();
                return;
            }

            document.getElementById('info-localidad').textContent = currentData.Localidad || '-';
            document.getElementById('info-municipio').textContent = currentData.Municipio || '-';
            document.getElementById('info-marginacion').textContent = currentData.GM_2020_y || '-';

            if (currentData.Latitud && currentData.Longitud) {
                map.setView([currentData.Latitud, currentData.Longitud], 14);
                marker.setLatLng([currentData.Latitud, currentData.Longitud]).bindPopup(`<b>${currentData.Localidad}</b>`).openPopup();
            }

            document.getElementById('pob-total').textContent = (currentData.POB1 || 0).toLocaleString();
            document.getElementById('pob-mujeres').textContent = (currentData.POB42 || 0).toLocaleString();
            document.getElementById('pob-hombres').textContent = (currentData.POB84 || 0).toLocaleString();
            document.getElementById('pob-hogares').textContent = (currentData.VIV0 || 0).toLocaleString();
            document.getElementById('viv-habitadas').textContent = (currentData.VIV0 || 0).toLocaleString();
            document.getElementById('viv-tierra').textContent = (currentData.VIV7 || 0).toLocaleString();
            document.getElementById('viv-hacinamiento').textContent = (currentData.VIV10 || 0).toLocaleString();
            
            const totalDiscapacidad = (currentData.DISC4 || 0) + (currentData.DISC5 || 0) + (currentData.DISC6 || 0);
            
            updateInfoRows(eduContainer, currentData, {
                'Analfabetas (15+)': { key: 'EDU28', color: 'var(--brand-brown)' },
                'B√°sica Incompleta (15+)': { key: 'EDU34', color: 'var(--brand-purple)' },
                'Ocupados sin Escolaridad': { key: 'ECO7', color: 'var(--brand-gold)' },
                'Ocupados Sec. Incompleta': { key: 'ECO13', color: 'var(--brand-green)' }
            });
            updateInfoRows(ticContainer, currentData, {
                'Viviendas con Celular': { key: 'VIV36', color: 'var(--brand-green)' },
                'Viviendas con Computadora': { key: 'VIV34', color: 'var(--brand-gold)' },
                'Viviendas con Tel. Fijo': { key: 'VIV35', color: 'var(--brand-dark-green)' }
            });
            updateInfoRows(demoContainer, {...currentData, totalDiscapacidad}, {
                'Pob. Afromexicana': { key: 'AFRO1', color: 'var(--brand-green)' },
                'Total con Discapacidad': { key: 'totalDiscapacidad', color: 'var(--brand-dark-green)' },
                'Discapacidad (0-14 a√±os)': { key: 'DISC4', color: 'var(--brand-purple)' },
                'Discapacidad (15-59 a√±os)': { key: 'DISC5', color: 'var(--brand-brown)' },
                'Discapacidad (60+ a√±os)': { key: 'DISC6', color: '#9CA3AF' }
            });
            updateInfoRows(healthContainer, currentData, {
                'Total Afiliados': { key: 'SALUD1', color: 'var(--brand-green)' },
                'Sin Afiliaci√≥n': { key: 'SALUD2', color: 'var(--brand-brown)' },
                'Afiliados al IMSS': { key: 'SALUD3', color: 'var(--brand-dark-green)' },
                'Afiliados al ISSSTE': { key: 'SALUD4', color: 'var(--brand-gold)' },
                'Afiliados a PEMEX/Marina': { key: 'SALUD6', color: 'var(--brand-purple)' }
            });
            
            updateCharts(currentData);
            geminiOutput.textContent = "Seleccione una opci√≥n para ver el an√°lisis de Gemini.";
            listenBtn.disabled = true;
        }
        
        function updateCharts(data) {
            const brandColors = {
                green: 'rgba(113, 120, 91, 0.8)', gold: 'rgba(188, 155, 115, 0.8)',
                darkGreen: 'rgba(46, 59, 43, 0.8)', purple: 'rgba(119, 51, 87, 0.8)',
                brown: 'rgba(124, 74, 54, 0.8)', lightGray: 'rgba(203, 202, 190, 0.8)'
            };
            const chartOptions = { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } };
            const printChartOptions = { ...chartOptions, animation: false, plugins: { legend: { display: false } } };
            Object.values(charts).forEach(chart => { if(chart) chart.destroy() });

            charts.bienes = new Chart(document.getElementById('bienesChart'), { type: 'bar', data: { labels: ['Refrigerador', 'Lavadora', 'Autom√≥vil', 'Bicicleta'], datasets: [{ label: 'Viviendas con', data: [data.VIV27, data.VIV28, data.VIV29, data.VIV81], backgroundColor: [brandColors.green, brandColors.gold, brandColors.darkGreen, brandColors.lightGray] }] }, options: window.matchMedia('print').matches ? printChartOptions : { ...chartOptions, indexAxis: 'y' } });
            charts.servicios = new Chart(document.getElementById('serviciosChart'), { type: 'bar', data: { labels: ['Agua Entubada', 'Serv. Sanitario', 'Energ√≠a El√©ctrica'], datasets: [{ label: 'Viviendas con', data: [data.VIV17, data.VIV20, data.VIV15], backgroundColor: [brandColors.green, brandColors.gold, brandColors.darkGreen] }] }, options: window.matchMedia('print').matches ? printChartOptions : chartOptions });
        }

        // --- GEMINI AI FUNCTIONS ---
        function formatDataForPrompt(data) {
            if (!data) return "No hay datos disponibles.";
            return `
- Localidad: ${data.Localidad}, Municipio: ${data.Municipio}
- Grado de Marginaci√≥n: ${data.GM_2020_y}
- Poblaci√≥n Total: ${data.POB1}, Mujeres: ${data.POB42}, Hombres: ${data.POB84}
- Viviendas: ${data.VIV0} totales, ${data.VIV7} con piso de tierra, ${data.VIV10} con hacinamiento.
- Educaci√≥n (15+ a√±os): ${data.EDU28} analfabetas, ${data.EDU34} con b√°sica incompleta.
- Salud: ${data.SALUD2} personas sin afiliaci√≥n a servicios de salud de ${data.POB1} totales.
- Econom√≠a: ${data.ECO1} personas ocupadas.
- Acceso a bienes: ${data.VIV27} viviendas con refrigerador, ${data.VIV28} con lavadora.
- Acceso a servicios: ${data.VIV17} viviendas con agua entubada, ${data.VIV15} con energ√≠a el√©ctrica.
- TIC: ${data.VIV36} viviendas con celular, ${data.VIV34} con computadora.
            `.trim();
        }

        async function callGeminiAPI(prompt) {
            loaderText.textContent = "Analizando datos con Gemini...";
            geminiLoader.style.display = 'flex';
            geminiOutput.textContent = '';
            generateSummaryBtn.disabled = true;
            suggestProjectsBtn.disabled = true;
            listenBtn.disabled = true;

            try {
                let chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
                const payload = { contents: chatHistory };
                const apiKey = "";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
                
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error(`Error en la API: ${response.statusText}`);
                const result = await response.json();
                
                if (result.candidates?.[0]?.content?.parts?.[0]?.text) {
                    const text = result.candidates[0].content.parts[0].text;
                    geminiOutput.textContent = text;
                    listenBtn.disabled = false; // Enable TTS button
                } else {
                    geminiOutput.textContent = "No se pudo obtener una respuesta de la IA. La estructura de la respuesta no es la esperada.";
                    console.error("Respuesta inesperada de la API:", result);
                }
            } catch (error) {
                console.error("Error al llamar a la API de Gemini:", error);
                geminiOutput.textContent = "Ocurri√≥ un error al contactar al servicio de IA. Por favor, int√©ntalo de nuevo m√°s tarde.";
            } finally {
                geminiLoader.style.display = 'none';
                generateSummaryBtn.disabled = false;
                suggestProjectsBtn.disabled = false;
            }
        }
        
        // --- NEW: GEMINI TTS FUNCTIONS ---
        function base64ToArrayBuffer(base64) {
            const binaryString = window.atob(base64);
            const len = binaryString.length;
            const bytes = new Uint8Array(len);
            for (let i = 0; i < len; i++) {
                bytes[i] = binaryString.charCodeAt(i);
            }
            return bytes.buffer;
        }

        function pcmToWav(pcmData, sampleRate) {
            const header = new ArrayBuffer(44);
            const view = new DataView(header);
            const numChannels = 1;
            const bitsPerSample = 16;
            const blockAlign = numChannels * bitsPerSample / 8;
            const byteRate = sampleRate * blockAlign;
            const dataSize = pcmData.byteLength;
            const fileSize = 36 + dataSize;
            view.setUint32(0, 0x52494646, false); // "RIFF"
            view.setUint32(4, fileSize, true);
            view.setUint32(8, 0x57415645, false); // "WAVE"
            view.setUint32(12, 0x666d7420, false); // "fmt "
            view.setUint32(16, 16, true); 
            view.setUint16(20, 1, true); 
            view.setUint16(22, numChannels, true);
            view.setUint32(24, sampleRate, true);
            view.setUint32(28, byteRate, true);
            view.setUint16(32, blockAlign, true);
            view.setUint16(34, bitsPerSample, true);
            view.setUint32(36, 0x64617461, false); // "data"
            view.setUint32(40, dataSize, true);
            return new Blob([header, pcmData], { type: 'audio/wav' });
        }

        async function callGeminiTTSAPI(textToSpeak) {
            loaderText.textContent = "Generando audio...";
            geminiLoader.style.display = 'flex';
            listenBtn.disabled = true;

            try {
                const payload = {
                    contents: [{ parts: [{ text: `Habla en un tono claro e informativo: ${textToSpeak}` }] }],
                    generationConfig: { responseModalities: ["AUDIO"] },
                    model: "gemini-2.5-flash-preview-tts"
                };
                const apiKey = "";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent?key=${apiKey}`;
                
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error(`Error en la API de TTS: ${response.statusText}`);
                const result = await response.json();
                
                const part = result?.candidates?.[0]?.content?.parts?.[0];
                const audioData = part?.inlineData?.data;
                const mimeType = part?.inlineData?.mimeType;

                if (audioData && mimeType && mimeType.startsWith("audio/")) {
                    const sampleRateMatch = mimeType.match(/rate=(\d+)/);
                    if (!sampleRateMatch) throw new Error("No se encontr√≥ la tasa de muestreo en el mimeType.");
                    
                    const sampleRate = parseInt(sampleRateMatch[1], 10);
                    const pcmData = base64ToArrayBuffer(audioData);
                    const wavBlob = pcmToWav(new Int16Array(pcmData), sampleRate);
                    const audioUrl = URL.createObjectURL(wavBlob);
                    
                    const audio = new Audio(audioUrl);
                    audio.play();
                } else {
                    throw new Error("La respuesta de la API de TTS no contiene datos de audio v√°lidos.");
                }
            } catch (error) {
                console.error("Error en la funci√≥n TTS:", error);
                geminiOutput.textContent += "\n\n(No se pudo generar el audio.)";
            } finally {
                geminiLoader.style.display = 'none';
                listenBtn.disabled = false;
            }
        }


        // --- EVENT LISTENERS ---
        generateSummaryBtn.addEventListener('click', () => {
            if (!currentData) {
                alert("Por favor, seleccione una localidad primero.");
                return;
            }
            const dataString = formatDataForPrompt(currentData);
            const prompt = `Act√∫a como un analista sociodemogr√°fico experto. Basado en los siguientes datos para la localidad de ${currentData.Localidad}, genera un resumen conciso (m√°ximo 3 p√°rrafos) destacando las principales fortalezas y debilidades en t√©rminos de poblaci√≥n, vivienda, educaci√≥n y salud. S√© directo y utiliza los datos para respaldar tus afirmaciones.\n\nDatos:\n${dataString}`;
            callGeminiAPI(prompt);
        });

        suggestProjectsBtn.addEventListener('click', () => {
            if (!currentData) {
                alert("Por favor, seleccione una localidad primero.");
                return;
            }
            const dataString = formatDataForPrompt(currentData);
            const prompt = `Act√∫a como un consultor de desarrollo comunitario. Analiza los siguientes datos para la localidad de ${currentData.Localidad} y sugiere 3 proyectos de alto impacto, presentados como una lista con vi√±etas. Para cada proyecto, explica brevemente el problema que aborda (usando los datos), la soluci√≥n propuesta y el impacto esperado. Enf√≥cate en las √°reas m√°s cr√≠ticas como educaci√≥n, salud y vivienda.\n\nDatos:\n${dataString}`;
            callGeminiAPI(prompt);
        });

        listenBtn.addEventListener('click', () => {
            const text = geminiOutput.textContent;
            if (text && text !== "Seleccione una opci√≥n para ver el an√°lisis de Gemini.") {
                callGeminiTTSAPI(text);
            }
        });

        poligonoFilter.addEventListener('change', updateLocalidadFilter);
        localidadFilter.addEventListener('change', updateDashboard);
        
        printButton.addEventListener('click', () => {
            if(currentData) {
                document.getElementById('print-localidad').textContent = currentData.Localidad || 'N/D';
                document.getElementById('print-municipio').textContent = currentData.Municipio || 'N/D';
                document.getElementById('print-date').textContent = `Generado el: ${new Date().toLocaleDateString('es-MX')} ${new Date().toLocaleTimeString('es-MX')}`;
            }
            window.print();
        });

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            initMap();
            populatePoligonoFilter();
            updateLocalidadFilter();
        });

    </script>
</body>
</html>
